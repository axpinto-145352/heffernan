{
  "name": "Lead Gen System",
  "nodes": [
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1856185975,
          "mode": "list",
          "cachedResultName": "Prompts",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=1856185975"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "specifyRangeA1",
              "range": "A1:B2"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1296,
        176
      ],
      "id": "13c99632-5153-4f8d-a3b1-fa168eb5d701",
      "name": "Fetch EE Prompts",
      "executeOnce": false,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "batchSize": 10,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        816,
        208
      ],
      "id": "1f9e7ddc-702c-478d-b09a-a5d8173daf3a",
      "name": "EE Batch Loop"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "204703a4-87bb-4b9d-b61e-f008180ce6f4",
              "leftValue": "={{ $('Has Bureau No EE').item.json['Bureau Number'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2560,
        160
      ],
      "id": "20931c42-9c17-48d6-8a0d-5b5f2674c56e",
      "name": "Check EE Updated OK"
    },
    {
      "parameters": {
        "content": "# Step 1: Process New WC prospects and find EE",
        "height": 352,
        "width": 2896,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        0
      ],
      "typeVersion": 1,
      "id": "cb84777e-2f42-41a9-a1e2-136b9f653d68",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "0. NEW HERE",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Bureau Number": "={{ $('Has Bureau No EE').item.json['Bureau Number'] }}",
            "Processing": "Done",
            "EE's": "={{ $json.employee_count }}",
            "EE Reasoning": "={{ $json.reasoning }}",
            "row_number": 0
          },
          "matchingColumns": [
            "Bureau Number"
          ],
          "schema": [
            {
              "id": "RateG",
              "displayName": "RateG",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "RateS1",
              "displayName": "RateS1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "RateS2",
              "displayName": "RateS2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Blended Rate",
              "displayName": "Blended Rate",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "EE's",
              "displayName": "EE's",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "EE Reasoning",
              "displayName": "EE Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "WC Premium (est)",
              "displayName": "WC Premium (est)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Company in Huddle?",
              "displayName": "Company in Huddle?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "If Yes, Has a P&C producer had meeting in last 12 mo?",
              "displayName": "If Yes, Has a P&C producer had meeting in last 12 mo?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "In EPIC as a Client?",
              "displayName": "In EPIC as a Client?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Heff CRM Check Okay?",
              "displayName": "Heff CRM Check Okay?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Manual Override to Add? (Trigger)",
              "displayName": "Manual Override to Add? (Trigger)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Final Okay to Add? (Trigger)",
              "displayName": "Final Okay to Add? (Trigger)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Bureau Number",
              "displayName": "Bureau Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Street Address",
              "displayName": "Street Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "City",
              "displayName": "City",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "State",
              "displayName": "State",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Zip Code",
              "displayName": "Zip Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "County",
              "displayName": "County",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Governing Class",
              "displayName": "Governing Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Description",
              "displayName": "Description",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ex Mod Year",
              "displayName": "Ex Mod Year",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod",
              "displayName": "ExMod",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Updated On",
              "displayName": "Updated On",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod Change",
              "displayName": "ExMod Change",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SubClass1",
              "displayName": "SubClass1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Desc1",
              "displayName": "Desc1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SubClass2",
              "displayName": "SubClass2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Desc2",
              "displayName": "Desc2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear1",
              "displayName": "PriorExModYear1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod1",
              "displayName": "PriorExMod1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear2",
              "displayName": "PriorExModYear2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod2",
              "displayName": "PriorExMod2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear3",
              "displayName": "PriorExModYear3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod3",
              "displayName": "PriorExMod3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear4",
              "displayName": "PriorExModYear4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod4",
              "displayName": "PriorExMod4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "GoogleSearch",
              "displayName": "GoogleSearch",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "CopyPasteURL",
              "displayName": "CopyPasteURL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Processing",
              "displayName": "Processing",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2208,
        160
      ],
      "id": "c243b768-d44f-4a7f-8175-e7589eb58db5",
      "name": "Update New Hire Sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "content": "# Step 2: Move Prospects to A. Renewal and Find Revenue, FP/NP Status and Domains",
        "height": 336,
        "width": 2896,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        352
      ],
      "typeVersion": 1,
      "id": "416a5410-4a5f-4601-beda-46971c490a32",
      "name": "Sticky Note2"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        448,
        848
      ],
      "id": "5e566323-3bab-411f-a520-14ff064fbb1b",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 95311764,
          "mode": "list",
          "cachedResultName": "Sources",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=95311764"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Bureau Number": "={{ $('Has Bureau No EE').item.json['Bureau Number'] }}",
            "Primary Name": "={{ $('Has Bureau No EE').item.json['Primary Name'] }}",
            "Sources (EE)": "={{ $('Parse EE data').item.json.search_results_numbered }}"
          },
          "matchingColumns": [
            "Bureau Number"
          ],
          "schema": [
            {
              "id": "Bureau Number",
              "displayName": "Bureau Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Sources (EE)",
              "displayName": "Sources (EE)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Sources (Revenue)",
              "displayName": "Sources (Revenue)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sources (POCs)",
              "displayName": "Sources (POCs)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "useAppend": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2384,
        160
      ],
      "id": "8458b634-b5e7-4aa0-a4f2-88d5a4d7e7bb",
      "name": "Update EE Sources",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "204703a4-87bb-4b9d-b61e-f008180ce6f4",
              "leftValue": "={{ $('Revenue Batch Loop').item.json['Bureau Number'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2512,
        528
      ],
      "id": "0d669554-fc2b-4a6c-86a5-83799a1213ef",
      "name": "Check Revenue Updated OK"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 861775990,
          "mode": "list",
          "cachedResultName": "1. Filtered Accounts & POCs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=861775990"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Bureau Number": "={{ $('Revenue Batch Loop').item.json['Bureau Number'] }}",
            "Revenue ($M)": "={{ $json.revenue_display }}",
            "Revenue Reasoning": "={{ $json.revenue_reasoning }}",
            "For-Profit/Non-Profit": "={{ $json.entity_type }}",
            "Profit/Non-Profit Reasoning": "={{ $json.entity_status_reasoning }}",
            "Domain": "={{ $json.company_domain }}",
            "Updated?": "=Done",
            "SIC Code": "={{ $json.perplexity_assistant_json.sic_code }}",
            "Industry": "={{ $json.perplexity_assistant_json.industry }}",
            "Ready for Seamless.AI": "Yes"
          },
          "matchingColumns": [
            "Bureau Number"
          ],
          "schema": [
            {
              "id": "Updated?",
              "displayName": "Updated?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "POC Done",
              "displayName": "POC Done",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Date Uploaded to Outreach (to \"WC Renewal\" Campaign)",
              "displayName": "Date Uploaded to Outreach (to \"WC Renewal\" Campaign)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Bureau Number",
              "displayName": "Bureau Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Street Address",
              "displayName": "Street Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "City",
              "displayName": "City",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "State",
              "displayName": "State",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Zip Code",
              "displayName": "Zip Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "County",
              "displayName": "County",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Governing Class",
              "displayName": "Governing Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Description",
              "displayName": "Description",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ex Mod Year",
              "displayName": "Ex Mod Year",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod",
              "displayName": "ExMod",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Updated On",
              "displayName": "Updated On",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod Change",
              "displayName": "ExMod Change",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SubClass1",
              "displayName": "SubClass1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Desc1",
              "displayName": "Desc1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SubClass2",
              "displayName": "SubClass2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Desc2",
              "displayName": "Desc2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear1",
              "displayName": "PriorExModYear1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod1",
              "displayName": "PriorExMod1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear2",
              "displayName": "PriorExModYear2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod2",
              "displayName": "PriorExMod2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear3",
              "displayName": "PriorExModYear3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod3",
              "displayName": "PriorExMod3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear4",
              "displayName": "PriorExModYear4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "For-Profit/Non-Profit",
              "displayName": "For-Profit/Non-Profit",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Profit/Non-Profit Reasoning",
              "displayName": "Profit/Non-Profit Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Industry",
              "displayName": "Industry",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "SIC Code",
              "displayName": "SIC Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Revenue ($M)",
              "displayName": "Revenue ($M)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Revenue Reasoning",
              "displayName": "Revenue Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Ready for Seamless.AI",
              "displayName": "Ready for Seamless.AI",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Prospect        ",
              "displayName": "Prospect        ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LI Profile",
              "displayName": "LI Profile",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ready to Move to Address List (Trigger)?",
              "displayName": "Ready to Move to Address List (Trigger)?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Moved to Address Labels",
              "displayName": "Moved to Address Labels",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Domain",
              "displayName": "Domain",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "POC #",
              "displayName": "POC #",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Verified Company Address",
              "displayName": "Verified Company Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Verifiy POC (method)",
              "displayName": "Verifiy POC (method)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Tenure (in role)",
              "displayName": "Tenure (in role)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2nd deg connections (R*)",
              "displayName": "2nd deg connections (R*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Common Network (P*)",
              "displayName": "Common Network (P*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LNKD Activity Level",
              "displayName": "LNKD Activity Level",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Unqiue notes for personalization (P*)",
              "displayName": "Unqiue notes for personalization (P*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "TBD",
              "displayName": "TBD",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "tbd",
              "displayName": "tbd",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2080,
        512
      ],
      "id": "e7896edf-f010-42c9-b01e-81373b8caf3e",
      "name": "Update Renewal (Revenue)",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 95311764,
          "mode": "list",
          "cachedResultName": "Sources",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=95311764"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Sources (Revenue)": "={{ $('Parse Data').item.json.source_urls_numbered }}",
            "Primary Name": "={{ $('Revenue Batch Loop').item.json['Primary Name'] }}",
            "Bureau Number": "={{ $('Revenue Batch Loop').item.json['Bureau Number'] }}"
          },
          "matchingColumns": [
            "Bureau Number"
          ],
          "schema": [
            {
              "id": "Bureau Number",
              "displayName": "Bureau Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Sources (EE)",
              "displayName": "Sources (EE)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sources (Revenue)",
              "displayName": "Sources (Revenue)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Sources (POCs)",
              "displayName": "Sources (POCs)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "useAppend": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2224,
        512
      ],
      "id": "0775185b-d0a2-401c-ae28-d6f01c92a0a5",
      "name": "Update Revenue Sources",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 861775990,
          "mode": "list",
          "cachedResultName": "1. Filtered Accounts & POCs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=861775990"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        672,
        496
      ],
      "id": "08fea967-a7e4-4aeb-ad18-5c8d7c152ac1",
      "name": "Renewal1",
      "retryOnFail": false,
      "executeOnce": false,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1856185975,
          "mode": "list",
          "cachedResultName": "Prompts",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=1856185975"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "specifyRangeA1",
              "range": "C1:D2"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        784,
        496
      ],
      "id": "146f13a2-f166-4a2b-a1ca-3f057cdb5f1c",
      "name": "Fetch Revenue Prompts",
      "executeOnce": false,
      "retryOnFail": true,
      "waitBetweenTries": 5000,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1616,
        432
      ],
      "id": "d2bb5dd0-be5f-45eb-824c-b2dc9e4eb7f9",
      "name": "Revenue Batch Loop",
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": "sonar-pro",
        "messages": {
          "message": [
            {
              "content": "={{ $json.prompts['Revenue System Message'] }}",
              "role": "system"
            },
            {
              "content": "=Company Name: {{ $json['Primary Name'] }}\n\nAddress Details:\nStreet: {{ $json['Street Address'] }}\nCity: {{ $json.City }}\nState: CA\n\n{{ $json.prompts['Revenue User Message'] }}"
            }
          ]
        },
        "options": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.perplexity",
      "typeVersion": 1,
      "position": [
        1776,
        512
      ],
      "id": "66e3ccb0-b35c-4686-af9e-6789df284a84",
      "name": "Rev Calc",
      "credentials": {
        "perplexityApi": {
          "id": "ZvICVqGzHHK8ddU0",
          "name": "Perplexity account"
        }
      },
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "content": "# Step 4: Update Renewal Sheet with POCs and LI Profile",
        "height": 464,
        "width": 1328,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        784,
        688
      ],
      "typeVersion": 1,
      "id": "20d80632-a57a-4e2b-8487-241b1d838ae7",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "model": "sonar-pro",
        "messages": {
          "message": [
            {
              "content": "={{ $json.prompts['System Message'] }}",
              "role": "system"
            },
            {
              "content": "=Company Name: {{ $json['Primary Name'] }}\nCompany Website: {{ $json.CopyPasteURL }}\n\nAddress Details:\nStreet: {{ $json['Street Address'] }}\nCity: {{ $json.City }}\nState: {{ $json.State }}\nZip Code: {{ $json['Zip Code'] }}\nCounty: {{ $json.County }}\nGoverning Class: {{ $json['Governing Class'] }}\nAdditional Description: {{ $json.Description }}\n\n{{ $json.prompts['User Message'] }}\n\n"
            }
          ]
        },
        "options": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.perplexity",
      "typeVersion": 1,
      "position": [
        1840,
        160
      ],
      "id": "84355f83-9e61-45b4-9493-72e1062191d7",
      "name": "Run EE calc",
      "credentials": {
        "perplexityApi": {
          "id": "ZvICVqGzHHK8ddU0",
          "name": "Perplexity account"
        }
      },
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbwm-4_STkCPYKSqEDYu-XHPi6WuQs8Sy5s5FhRc6JAolTsRlvRyhNrcs2nFo_t6DtVKbQ/exec",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{ \"trigger\": \"reformatARenewalRowsMenu\" }\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2160,
        368
      ],
      "id": "5e840a3b-ca27-4125-a935-c42fc4b1eb4b",
      "name": "Format Rows"
    },
    {
      "parameters": {
        "content": "# Step 5: Move Over Info to Address List (For Profit)",
        "height": 496,
        "width": 1760,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2112,
        688
      ],
      "typeVersion": 1,
      "id": "9d1af128-69d4-46ba-82fe-6cf53c930faf",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 618105269,
          "mode": "list",
          "cachedResultName": "Address Labels (General)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=618105269"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Title": "={{ $json.Title }}",
            "Primary Name": "={{ $json['Primary Name'] }}",
            "State": "={{ $json.State }}",
            "Street Address": "={{ $json['Street Address'] }}",
            "City": "={{ $json.City }}",
            "Zip Code": "={{ $json['Zip Code'] }}",
            "Prospect": "={{ $json['Prospect        '] }}",
            "Sent from A. Renewal": "Done",
            "ExMod": "={{ $json.ExMod }}"
          },
          "matchingColumns": [
            "Prospect"
          ],
          "schema": [
            {
              "id": "row number",
              "displayName": "row number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Street Address",
              "displayName": "Street Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "City",
              "displayName": "City",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "State",
              "displayName": "State",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Zip Code",
              "displayName": "Zip Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Prospect",
              "displayName": "Prospect",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ExMod",
              "displayName": "ExMod",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Corrected Name",
              "displayName": "Corrected Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Corrected Name Reasoning",
              "displayName": "Corrected Name Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Combined Address",
              "displayName": "Combined Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Test Label",
              "displayName": "Test Label",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Label",
              "displayName": "Label",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Label #",
              "displayName": "Label #",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sent from A. Renewal",
              "displayName": "Sent from A. Renewal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Ready to send to Address Labels Doc? (Trigger)",
              "displayName": "Ready to send to Address Labels Doc? (Trigger)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sent to Doc",
              "displayName": "Sent to Doc",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "useAppend": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2912,
        768
      ],
      "id": "4294ada4-848e-48b0-aab1-d11b4ff7de52",
      "name": "Update Address List",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Address Label (Code node)\n// MODE: Run Once for All Items\n// - Preserves existing Label # if already set on the row\n// - Assigns new Label # only when Prospect is present AND Label # is blank\n// - Skips rows with no definite contact (no Prospect)\n// - Outputs ONLY rows that should update the Doc + Sheet\n// - NOW: Tracks prospect name for bold formatting\nconst start =\n  $('Get Next Label Start')?.first()?.json?.nextStart ??\n  $('Get Next Label Start')?.item?.json?.nextStart ??\n  1;\nfunction extractLabelNumber(v) {\n  if (v == null) return null;\n  const s = String(v).trim();\n  const m = s.match(/\\{\\{\\s*Label\\s*(\\d+)\\s*\\}\\}/i);\n  return m ? Number(m[1]) : null;\n}\nfunction hasText(v) {\n  return v != null && String(v).trim() !== '';\n}\n// \"Definite contact\" = Prospect present\nfunction isDefiniteContact(r) {\n  return hasText(r['Prospect']);\n}\nlet assignedCount = 0;\nconst out = [];\nfor (const item of items) {\n  const r = item.json || {};\n  \n  // Skip if not a definite contact\n  if (!isDefiniteContact(r)) continue;\n  \n  // Build labelText\n  const prospect = r['Prospect'] ?? null;\n  const correctedName =\n    r['corrected_name'] ??\n    r['Corrected Name'] ??\n    r['Primary Name'] ??\n    null;\n  const street = r['Street Address'] ?? null;\n  const city = r['City'] ?? null;\n  const state = r['State'] ?? null;\n  const zip = r['Zip Code'] ?? null;\n  \n  const lines = [\n    prospect,\n    correctedName,\n    street,\n    [city, state, zip].filter(hasText).join(' '),\n  ].filter(hasText);\n  \n  const labelText = lines.join('\\n');\n  \n  // If labelText ended up empty somehow, skip\n  if (!hasText(labelText)) continue;\n  \n  // Preserve existing Label # if present\n  const existingLabelPlaceholder =\n    r['Label #'] ??\n    r['Label#'] ??\n    r.labelPlaceholder ??\n    null;\n  const existingN = extractLabelNumber(existingLabelPlaceholder);\n  \n  let labelIndex;\n  if (Number.isFinite(existingN) && existingN > 0) {\n    // KEEP existing label number\n    labelIndex = existingN;\n  } else {\n    // Assign next available label number\n    labelIndex = Number(start) + assignedCount;\n    assignedCount += 1;\n  }\n  \n  const labelPlaceholder = `{{Label${labelIndex}}}`;\n  \n  out.push({\n    json: {\n      ...r,\n      labelIndex,\n      labelPlaceholder,\n      labelText,\n      prospectName: prospect // For bold formatting\n    },\n  });\n}\nreturn out;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2672,
        1056
      ],
      "id": "653a105a-5c76-4f08-8adb-182e89d998e2",
      "name": "Address Label"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 618105269,
          "mode": "list",
          "cachedResultName": "Address Labels (General)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=618105269"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Corrected Name": "={{ $json.corrected_name }}",
            "Corrected Name Reasoning": "={{ $json.rationale }}",
            "Prospect": "={{ $('Update Address List').item.json.Prospect }}"
          },
          "matchingColumns": [
            "Prospect"
          ],
          "schema": [
            {
              "id": "row number",
              "displayName": "row number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Street Address",
              "displayName": "Street Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "City",
              "displayName": "City",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "State",
              "displayName": "State",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Zip Code",
              "displayName": "Zip Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Prospect",
              "displayName": "Prospect",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod",
              "displayName": "ExMod",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Corrected Name",
              "displayName": "Corrected Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Corrected Name Reasoning",
              "displayName": "Corrected Name Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Combined Address",
              "displayName": "Combined Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Test Label",
              "displayName": "Test Label",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Label",
              "displayName": "Label",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Label #",
              "displayName": "Label #",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sent from A. Renewal",
              "displayName": "Sent from A. Renewal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ready to send to Address Labels Doc? (Trigger)",
              "displayName": "Ready to send to Address Labels Doc? (Trigger)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sent to Doc",
              "displayName": "Sent to Doc",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "useAppend": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3488,
        768
      ],
      "id": "f810ccad-5107-425c-9a38-392eb421a7e3",
      "name": "Update Address List1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1856185975,
          "mode": "list",
          "cachedResultName": "Prompts",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=1856185975"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "specifyRangeA1",
              "range": "E1:F2"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3056,
        768
      ],
      "id": "7d566af0-de79-4014-a083-23dabbd85089",
      "name": "Prompts 1",
      "executeOnce": false,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// Parse Output (n8n Code node)\n// Mode: Run Once for Each Item\n// Reads model output from common OpenAI shapes\n// Returns: primary_name, corrected_name, confidence, rationale\n// (+ raw, parse_error for debugging)\n\nfunction stripCodeFences(s) {\n  if (typeof s !== \"string\") return s;\n  let out = s.trim();\n  out = out.replace(/^```(?:json)?\\s*/i, \"\");\n  out = out.replace(/```$/i, \"\");\n  return out.trim();\n}\n\nfunction extractFirstJsonObject(s) {\n  if (typeof s !== \"string\") return null;\n  const start = s.indexOf(\"{\");\n  if (start === -1) return null;\n  let depth = 0;\n  for (let i = start; i < s.length; i++) {\n    const ch = s[i];\n    if (ch === \"{\") depth++;\n    if (ch === \"}\") depth--;\n    if (depth === 0) return s.slice(start, i + 1);\n  }\n  return null;\n}\n\n// 1) Get raw model output text (support multiple shapes)\nlet raw =\n  $json?.output?.[0]?.content?.[0]?.text ??\n  $json?.output?.[0]?.content?.[0]?.output_text ??\n  $json?.output?.[0]?.content?.[0]?.logprobs?.text ??\n  $json?.choices?.[0]?.message?.content ??  // ADDED: OpenAI format\n  $json?.text ??\n  null;\n\n// NEW: allow direct object input (already-parsed JSON)\nif (raw == null && typeof $json === \"object\" && !Array.isArray($json)) {\n  raw = JSON.stringify($json);\n}\n\nraw = typeof raw === \"string\" ? raw : JSON.stringify(raw ?? \"\");\n\n// 2) Clean\nlet cleaned = stripCodeFences(raw);\n\n// 3) Parse (with double-parse for escaped JSON strings)\nlet parsed = null;\nlet parseError = null;\n\ntry {\n  parsed = JSON.parse(cleaned);\n  \n  // CRITICAL FIX: Check if parsed result is a STRING containing JSON\n  // This happens when LLM returns: \"{\\n \\\"key\\\": \\\"value\\\"\\n}\"\n  if (typeof parsed === \"string\") {\n    // It's a double-encoded JSON string - parse again\n    cleaned = stripCodeFences(parsed);\n    parsed = JSON.parse(cleaned);\n  }\n  \n} catch (e1) {\n  // Try extracting first JSON object\n  const candidate = extractFirstJsonObject(cleaned);\n  if (candidate) {\n    try {\n      parsed = JSON.parse(candidate);\n      \n      // Check again for double-encoding\n      if (typeof parsed === \"string\") {\n        cleaned = stripCodeFences(parsed);\n        parsed = JSON.parse(cleaned);\n      }\n      \n    } catch (e2) {\n      parseError = e2?.message || String(e2);\n    }\n  } else {\n    parseError = e1?.message || String(e1);\n  }\n}\n\n// Ensure parsed is a plain object\nif (!parsed || typeof parsed !== \"object\" || Array.isArray(parsed)) {\n  if (!parseError) parseError = \"Parsed JSON was not an object.\";\n  parsed = null;\n}\n\n// 4) Return ONE item\nreturn {\n  json: {\n    primary_name: parsed?.primary_name ?? null,\n    corrected_name: parsed?.corrected_name ?? null,\n    confidence: parsed?.confidence ?? null,\n    rationale: parsed?.rationale ?? null,\n    raw: cleaned,\n    parse_error: parseError,\n  },\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3328,
        768
      ],
      "id": "44be98c4-1214-4829-98a5-907b55f2d1c0",
      "name": "Parse Output"
    },
    {
      "parameters": {
        "batchSize": 10,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2704,
        752
      ],
      "id": "4b4aa624-cb42-4d91-89cb-7598a973689e",
      "name": "Address Label FP Loop"
    },
    {
      "parameters": {
        "operation": "update",
        "documentURL": "https://docs.google.com/document/d/1Abb062YsZRy6zX9wppDBD7n2XTMVOEP7bPLBKQMv-2c/edit?usp=sharing",
        "actionsUi": {
          "actionFields": [
            {
              "action": "replaceAll",
              "text": "={{ $('Doc Update FP Loop').item.json.labelPlaceholder }}",
              "replaceText": "={{ $('Doc Update FP Loop').item.json.labelText }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        3296,
        1008
      ],
      "id": "fe23a6e1-60de-4d60-879b-b753aa47d92c",
      "name": "Update a document",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "yPYUETCJjDJpwfng",
          "name": "Google Docs account"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 618105269,
          "mode": "list",
          "cachedResultName": "Address Labels (General)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=618105269"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Label": "={{ $json.labelText }}",
            "Label #": "={{ $json.labelPlaceholder }}",
            "Prospect": "={{ $json.Prospect }}",
            "Sent to Doc": "Done"
          },
          "matchingColumns": [
            "Prospect"
          ],
          "schema": [
            {
              "id": "row number",
              "displayName": "row number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Street Address",
              "displayName": "Street Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "City",
              "displayName": "City",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "State",
              "displayName": "State",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Zip Code",
              "displayName": "Zip Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Prospect",
              "displayName": "Prospect",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod",
              "displayName": "ExMod",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Corrected Name",
              "displayName": "Corrected Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Corrected Name Reasoning",
              "displayName": "Corrected Name Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Combined Address",
              "displayName": "Combined Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Test Label",
              "displayName": "Test Label",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Label",
              "displayName": "Label",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Label #",
              "displayName": "Label #",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Sent from A. Renewal",
              "displayName": "Sent from A. Renewal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ready to send to Address Labels Doc? (Trigger)",
              "displayName": "Ready to send to Address Labels Doc? (Trigger)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sent to Doc",
              "displayName": "Sent to Doc",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "useAppend": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3120,
        1008
      ],
      "id": "0c23340f-b744-4e5e-bf64-d18f680efa9d",
      "name": "Update Address List2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "77d757a8-d8a2-46c5-80a4-835a749bcbfc",
              "leftValue": "={{ $json['Bureau Number'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            },
            {
              "id": "f5d36cfb-85a4-4f8e-bfd6-e274bed25ba6",
              "leftValue": "={{ $json['EE\\'s'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1072,
        160
      ],
      "id": "3e2978c7-6b4e-4eea-ba9d-aa1df26f1aee",
      "name": "Has Bureau No EE"
    },
    {
      "parameters": {
        "amount": 15
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        2352,
        544
      ],
      "id": "1301fa7d-acb9-4380-8eac-bfabf43ac7ea",
      "name": "Wait Revenue Cooldown",
      "webhookId": "16b405e8-6215-40ac-83b1-4a9c3ee86419"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "fc773bd9-140c-4a48-b5ed-be554a9b3d3c",
              "leftValue": "={{ $json['Updated?'] }}",
              "rightValue": "Done",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            },
            {
              "id": "a617ef35-62f5-46ac-8a1f-d11325387672",
              "leftValue": "={{ $json['Bureau Number'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1232,
        496
      ],
      "id": "57251124-8379-458b-883b-9d4cd952e7f6",
      "name": "Filter Unprocessed Revenue"
    },
    {
      "parameters": {
        "jsCode": "// Dedupe companies before Loop Over Items\n// Mode: Run Once for All Items\n\nconst items = $input.all();\n\n// Pick your best unique key(s). Adjust names to match your actual JSON fields.\nfunction getKey(j) {\n  const bureau =\n    j[\"Bureau Number\"] ??\n    j[\"BureauNumber\"] ??\n    j[\"bureau_number\"] ??\n    j[\"bureauNumber\"] ??\n    null;\n\n  const name =\n    j[\"Primary Name\"] ??\n    j[\"PrimaryName\"] ??\n    j[\"primary_name\"] ??\n    j[\"primaryName\"] ??\n    null;\n\n  const domain =\n    j[\"Domain\"] ??\n    j[\"domain\"] ??\n    null;\n\n  // Prefer Bureau Number, then Domain, then Name\n  return String(bureau ?? domain ?? name ?? \"\").trim().toLowerCase();\n}\n\nconst seen = new Set();\nconst out = [];\n\nfor (const item of items) {\n  const key = getKey(item.json);\n\n  // If there's no usable key, keep it (so you don't accidentally drop data)\n  if (!key) {\n    out.push(item);\n    continue;\n  }\n\n  if (!seen.has(key)) {\n    seen.add(key);\n    out.push(item); // keep first occurrence only\n  }\n}\n\nreturn out;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1456,
        432
      ],
      "id": "3894d8f9-30c2-4a97-9c16-2aed49a639ab",
      "name": "Dedupe"
    },
    {
      "parameters": {
        "jsCode": "// n8n Code node (JavaScript) — Run Once for All Items\n// EXPECTED INPUT: from a Merge node in \"Multiplex\" mode combining:\n// - Loop Over Items (N items)\n// - Prompts (usually 1 item, but can be multiple)\n//\n// OUTPUT:\n// - N items (same as loop count)\n// - Each item: { ...loopFields, prompts: { ... } }\n\nfunction asObject(v) {\n  return v && typeof v === \"object\" && !Array.isArray(v) ? v : {};\n}\n\nconst incoming = ($input?.all?.() ?? []).filter(Boolean);\nif (incoming.length === 0) {\n  return [{ json: { error: \"No incoming items. Check Merge → Code connection.\" } }];\n}\n\n// Identify prompts vs loop by common keys in your screenshot\nfunction isPrompts(j) {\n  return j && (j[\"User Message\"] !== undefined || j[\"System Message\"] !== undefined);\n}\n\nfunction isLoop(j) {\n  return j && (j[\"Primary Name\"] !== undefined || j[\"Bureau Number\"] !== undefined || j[\"WC Premium (est)\"] !== undefined);\n}\n\n// Collect prompts rows\nconst promptsRows = incoming.map(i => asObject(i.json)).filter(isPrompts);\nif (promptsRows.length === 0) {\n  return [{ json: { error: 'No Prompts rows found in merged input. Ensure Prompts is connected into Merge (Multiplex).' } }];\n}\n\n// Make ONE prompts object (merge rows if multiple)\nconst prompts = promptsRows.reduce((acc, cur) => Object.assign(acc, cur), {});\n\n// Collect loop rows\nconst loopRows = incoming.map(i => asObject(i.json)).filter(isLoop);\n\n// If Multiplex was used, incoming items often already contain both.\n// So we derive loop rows by taking \"non-prompt\" items if needed.\nconst finalLoopRows = loopRows.length > 0\n  ? loopRows\n  : incoming.map(i => asObject(i.json)).filter(j => !isPrompts(j));\n\nif (finalLoopRows.length === 0) {\n  return [{ json: { error: 'No Loop Over Items rows found in merged input. Ensure Loop Over Items is connected into Merge (Multiplex).' } }];\n}\n\n// Output one item per loop row\nreturn finalLoopRows.map(loop => ({\n  json: {\n    ...loop,\n    prompts,\n  }\n}));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1664,
        160
      ],
      "id": "cf582dca-59c7-48ee-98e5-15bba2daa955",
      "name": "Combine data"
    },
    {
      "parameters": {
        "jsCode": "// Combine data1 (Code node) — Run Once for All Items\n// Works with n8n's \"multi-input\" behavior where all incoming connections are APPENDED\n// into ONE stream (so Prompts + Renewal1 arrive mixed together).\n//\n// Output: N items (same as Renewal rows), each with a single nested `prompts` object.\n\nfunction isPlainObject(v) {\n  return v !== null && typeof v === \"object\" && !Array.isArray(v);\n}\n\nfunction deepClone(v) {\n  try {\n    return JSON.parse(JSON.stringify(v));\n  } catch (e) {\n    return v;\n  }\n}\n\nconst incoming = $input.all().map(i => (i && i.json) ? i.json : {});\nif (incoming.length === 0) {\n  return [{ json: { error: \"No incoming items to Combine data1.\" } }];\n}\n\n// Heuristics to detect which item is Prompts vs Renewal\nfunction looksLikePrompts(obj) {\n  if (!isPlainObject(obj)) return false;\n\n  // Strong signals from your Prompts sheet columns\n  const hasRevenueUser = typeof obj[\"Revenue User Message\"] === \"string\";\n  const hasRevenueSystem = typeof obj[\"Revenue System Message\"] === \"string\";\n\n  // If it has BOTH, it's definitely the prompts row\n  if (hasRevenueUser && hasRevenueSystem) return true;\n\n  // Otherwise, still likely prompts if it has message-ish keys and lacks renewal keys\n  const hasAnyMessageKey = Object.keys(obj).some(k => /message/i.test(k));\n  const hasRenewalKey =\n    obj[\"Bureau Number\"] != null ||\n    obj[\"Primary Name\"] != null ||\n    obj[\"Street Address\"] != null ||\n    obj[\"Renew Date\"] != null;\n\n  return hasAnyMessageKey && !hasRenewalKey;\n}\n\nfunction looksLikeRenewal(obj) {\n  if (!isPlainObject(obj)) return false;\n  return (\n    obj[\"Bureau Number\"] != null ||\n    obj[\"Primary Name\"] != null ||\n    obj[\"Street Address\"] != null ||\n    obj[\"Renew Date\"] != null\n  );\n}\n\nconst promptItems = incoming.filter(looksLikePrompts);\nconst renewalItems = incoming.filter(looksLikeRenewal);\n\n// If your Renewal rows don't have those keys for some reason, fallback:\nconst fallbackRenewals =\n  renewalItems.length > 0 ? renewalItems : incoming.filter(o => !looksLikePrompts(o));\n\n// Build ONE prompts object (merge if somehow multiple prompt rows exist)\nif (promptItems.length === 0) {\n  return [{\n    json: {\n      error: \"No Prompts item found in incoming stream. Ensure Prompts node is connected into this Code node (parallel) or merged in before it.\",\n      incoming_count: incoming.length,\n    }\n  }];\n}\n\nconst prompts = {};\nfor (const p of promptItems) {\n  if (isPlainObject(p)) Object.assign(prompts, deepClone(p));\n}\n\nif (fallbackRenewals.length === 0) {\n  return [{\n    json: {\n      error: \"No Renewal items found in incoming stream.\",\n      incoming_count: incoming.length,\n      prompts_detected: promptItems.length\n    }\n  }];\n}\n\n// Fan-out: attach the SAME prompts object to each renewal row\nreturn fallbackRenewals.map(rowRaw => {\n  const row = deepClone(rowRaw);\n  if (isPlainObject(row) && Object.prototype.hasOwnProperty.call(row, \"prompts\")) {\n    delete row.prompts; // prevent accidental double-nesting\n  }\n  return {\n    json: {\n      ...row,\n      prompts,\n    },\n  };\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1072,
        448
      ],
      "id": "6c318b17-b03b-48e9-a9ad-ecc013504594",
      "name": "Combine data1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        944,
        448
      ],
      "id": "72fe1463-1777-4827-af3e-229c82580a3c",
      "name": "Merge Revenue + Prompts"
    },
    {
      "parameters": {
        "jsCode": "// Get Next Label Start (Code node)\n// MODE: Run Once for All Items\n// Reads all existing rows from Address Labels1 and finds the max {{LabelN}} already used\n\nconst rows = $items('If3') || [];\n\nfunction extractLabelNumber(v) {\n  if (v == null) return null;\n  const s = String(v).trim();\n  const m = s.match(/\\{\\{\\s*Label\\s*(\\d+)\\s*\\}\\}/i);\n  return m ? Number(m[1]) : null;\n}\n\nlet maxUsed = 0;\n\nfor (const it of rows) {\n  const r = it.json || {};\n\n  // Your sheet column header appears to be \"Label #\"\n  const n = extractLabelNumber(r['Label #'] ?? r['Label#'] ?? r['Label_Number']);\n  if (Number.isFinite(n) && n > maxUsed) maxUsed = n;\n}\n\nreturn [\n  {\n    json: {\n      maxUsed,\n      nextStart: maxUsed + 1,\n    },\n  },\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2672,
        912
      ],
      "id": "08b24ee7-afb8-44a4-8b30-2ca2d93d2f57",
      "name": "Get Next Label Start"
    },
    {
      "parameters": {
        "model": "sonar-pro",
        "messages": {
          "message": [
            {
              "content": "={{ $json['Corrected Name System Message'] }}",
              "role": "system"
            },
            {
              "content": "=Company Name: {{ $('Address Label FP Loop').item.json['Primary Name'] }}\nCompany Website: {{ $('Address Label FP Loop').item.json.CopyPasteURL }}\n\nAddress Details:\nStreet: {{ $('Address Label FP Loop').item.json['Street Address'] }}\nCity: {{ $('Address Label FP Loop').item.json.City }}\nState: {{ $('Address Label FP Loop').item.json.State }}\nGoverning Class: {{ $('Address Label FP Loop').item.json['Governing Class'] }}\nAdditional Description: {{ $('Address Label FP Loop').item.json.Description }}\n\n{{ $json['Corrected Name User Message'] }}"
            }
          ]
        },
        "options": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.perplexity",
      "typeVersion": 1,
      "position": [
        3200,
        768
      ],
      "id": "443aca7e-d012-4ade-b24e-eeb4397e583a",
      "name": "Corrected Name",
      "credentials": {
        "perplexityApi": {
          "id": "ZvICVqGzHHK8ddU0",
          "name": "Perplexity account"
        }
      },
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbzW6Tiwu-dMfSwkj07QsDCYw6gFD4kUi27ACauzPy3QjlpyzLbczIEaXdMfaiPIozdJ5g/exec",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"trigger\": \"bold_lowercase\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        3504,
        1008
      ],
      "id": "9c3415db-03c3-462c-80a4-431ffbeb5ecc",
      "name": "Bold Labels"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 861775990,
          "mode": "list",
          "cachedResultName": "1. Filtered Accounts & POCs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=861775990"
        },
        "event": "rowAdded",
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTrigger",
      "typeVersion": 1,
      "position": [
        48,
        432
      ],
      "id": "65d1acc3-14d7-4897-b1ae-e35cd59614ce",
      "name": "Google Sheets Trigger",
      "credentials": {
        "googleSheetsTriggerOAuth2Api": {
          "id": "8ZGBY0PyadPJ9WWA",
          "name": "Google Sheets Trigger account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// n8n Code node (Run Once for All Items)\n// Purpose: ensure the Format Rows webhook is called exactly once\n\nreturn [\n  {\n    json: {\n      trigger: \"reformatARenewalRowsMenu\",\n    },\n  },\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1856,
        368
      ],
      "id": "1d234c53-a82c-4ccf-9fce-9664c65c8304",
      "name": "Send Format Rows trigger once"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// Runs once per item in n8n\n// Assumes:\n//   - The model's JSON output is in: $json.choices[0].message.content\n//   - The search results array is in: $json.search_results\n\nconst root = { ...$json };\n\n// -----------------------------\n// 1) Get and normalize content\n// -----------------------------\nlet rawContent = root.choices?.[0]?.message?.content ?? '';\n\nif (typeof rawContent !== 'string') {\n  rawContent = String(rawContent ?? '');\n}\n\nlet contentStr = rawContent.trim();\n\n// If it's wrapped in ```json ... ``` remove the fences\nconst fencedMatch = contentStr.match(/```json\\s*([\\s\\S]*?)```/i);\nif (fencedMatch && fencedMatch[1]) {\n  contentStr = fencedMatch[1].trim();\n}\n\nlet parsed = null;\ntry {\n  parsed = JSON.parse(contentStr);\n} catch (e) {\n  parsed = null;\n}\n\n// Default fields\nlet employeeCount = null;\nlet reasoning = '';\nlet sourceUrls = [];\n\n// If we successfully parsed the JSON, extract fields\nif (parsed && typeof parsed === 'object') {\n  if (typeof parsed.employee_count === 'number') {\n    employeeCount = parsed.employee_count;\n  }\n  if (typeof parsed.reasoning === 'string') {\n    reasoning = parsed.reasoning;\n  }\n  if (Array.isArray(parsed.source_urls)) {\n    sourceUrls = parsed.source_urls\n      .filter(u => typeof u === 'string' && u.trim() !== '');\n  }\n}\n\n// -----------------------------\n// 2) Numbered URLs from content\n// -----------------------------\nconst sourceUrlsNumbered = sourceUrls.length\n  ? sourceUrls.map((u, i) => `${i + 1}. ${u}`).join('\\n')\n  : '';\n\n// -----------------------------\n// 3) Numbered URLs from search_results\n// -----------------------------\nlet searchResultsUrls = [];\n\nif (Array.isArray(root.search_results)) {\n  for (const sr of root.search_results) {\n    let url = '';\n\n    if (typeof sr === 'string') {\n      url = sr;\n    } else if (sr && typeof sr === 'object') {\n      // Adjust keys if your search_results structure differs\n      url =\n        sr.url ||\n        sr.link ||\n        sr.source_url ||\n        sr.href ||\n        '';\n    }\n\n    if (url && !searchResultsUrls.includes(url)) {\n      searchResultsUrls.push(url);\n    }\n  }\n}\n\nconst searchResultsNumbered = searchResultsUrls.length\n  ? searchResultsUrls.map((u, i) => `${i + 1}. ${u}`).join('\\n')\n  : '';\n\n// -----------------------------\n// 4) Attach fields to root\n// -----------------------------\nroot.employee_count = employeeCount;\nroot.reasoning = reasoning;\nroot.source_urls = sourceUrls;\nroot.source_urls_numbered = sourceUrlsNumbered;\nroot.search_results_numbered = searchResultsNumbered;\n\nreturn root;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2016,
        160
      ],
      "id": "35cb95cd-3e0b-491b-9fb6-ca2988a11ceb",
      "name": "Parse EE data"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// n8n Code node\n// MODE: Run Once for Each Item\n// UPDATE: supports Perplexity node output that is an ARRAY with a single object:\n//   [ { id, model, citations[], search_results[], choices[0].message.content (JSON string), ... } ]\n//\n// This version:\n// - Detects and unwraps the array payload\n// - Parses choices[0].message.content JSON string (handles fenced JSON too)\n// - Extracts *all* useful fields from BOTH:\n//   (A) wrapper object (citations, search_results, usage, etc.)\n//   (B) assistant JSON content (company_domain, revenue_value/low/high, entity_status, reasonings, source_urls, etc.)\n// - Keeps your normalized fields AND adds \"perplexity_*\" raw fields for downstream use\n\n// -----------------------------\n// 0) Unwrap array payload if needed\n// -----------------------------\nconst incoming = $json;\nconst wrapper =\n  Array.isArray(incoming) ? (incoming[0] || {}) :\n  (incoming && typeof incoming === 'object' ? incoming : {});\n\n// Start output with wrapper fields so nothing is lost\nconst data = { ...wrapper };\n\n// -----------------------------\n// 1) Get visible content (string) if present\n// -----------------------------\nlet rawContent =\n  wrapper.choices?.[0]?.message?.content ??\n  wrapper.choices?.[0]?.message?.content_text ??\n  wrapper.text ??\n  '';\n\nif (typeof rawContent !== 'string') rawContent = String(rawContent || '');\n\n// Remove <think> blocks\nconst thinkRegex = /<think>[\\s\\S]*?<\\/think>\\s*/gi;\nlet content = rawContent.replace(thinkRegex, '').trim();\n\n// Extract URLs early so we don't lose them\nconst urlRegex = /https?:\\/\\/[^\\s\\)\\]]+/gi;\nconst embeddedUrls = content.match(urlRegex) || [];\nconst contentNoUrls = content.replace(urlRegex, ' ');\n\n// -----------------------------\n// 2) Result object (normalized)\n// -----------------------------\nconst result = {\n  // entity\n  entity_type: 'unknown',             // \"General\" or \"Non-Profit\"\n  nonprofit_classification: null,     // e.g. \"501(c)(3)\"\n  entity_status_reasoning: null,\n\n  // revenue\n  revenue_value: null,\n  revenue_found: false,\n  revenue_display: null,\n  revenue_reasoning: null,\n  revenue_range_min: null,\n  revenue_range_max: null,\n  is_estimate: null,\n\n  // domain\n  company_domain: null,\n  domain_reasoning: null,\n\n  // sources\n  source_urls: [],\n  source_urls_numbered: '',\n\n  // extra: keep the assistant JSON fields if present (no data loss)\n  extra: {}\n};\n\n// -----------------------------\n// 3) Parse structured JSON from assistant content (supports fenced/raw)\n// -----------------------------\nlet parsedJson = null;\n\nfunction extractTopLevelJson(str) {\n  const start = str.indexOf('{');\n  if (start === -1) return null;\n\n  let depth = 0;\n  let inString = false;\n  let escaped = false;\n  let end = -1;\n\n  for (let i = start; i < str.length; i++) {\n    const ch = str[i];\n\n    if (escaped) { escaped = false; continue; }\n    if (ch === '\\\\') { escaped = true; continue; }\n    if (ch === '\"') { inString = !inString; continue; }\n    if (inString) continue;\n\n    if (ch === '{') depth++;\n    if (ch === '}') depth--;\n\n    if (depth === 0) { end = i + 1; break; }\n  }\n\n  if (end === -1) return null;\n  return str.slice(start, end);\n}\n\n// A) If wrapper itself already looks like the flat schema (rare here), use it\nconst looksLikeFlatSchema =\n  wrapper &&\n  typeof wrapper === 'object' &&\n  (typeof wrapper.entity_status === 'string' ||\n    typeof wrapper.revenue_value === 'number' ||\n    typeof wrapper.latest_annual_revenue === 'number' ||\n    typeof wrapper.company_name === 'string');\n\nif (looksLikeFlatSchema) parsedJson = wrapper;\n\n// B) fenced ```json\nif (!parsedJson) {\n  const fenced = content.match(/```json\\s*([\\s\\S]*?)```/i);\n  if (fenced && fenced[1]) {\n    try { parsedJson = JSON.parse(fenced[1]); } catch (e) {}\n  }\n}\n\n// C) whole content as JSON\nif (!parsedJson) {\n  try { parsedJson = JSON.parse(content); } catch (e) {}\n}\n\n// D) extract first top-level object\nif (!parsedJson) {\n  const extracted = extractTopLevelJson(content);\n  if (extracted) {\n    try { parsedJson = JSON.parse(extracted); } catch (e) {}\n  }\n}\n\n// -----------------------------\n// 4) Normalize parsed JSON (assistant content) into result\n// -----------------------------\nif (parsedJson && typeof parsedJson === 'object') {\n  // Keep everything from assistant JSON in extra, so nothing is dropped\n  result.extra = { ...parsedJson };\n\n  // Domain\n  if (typeof parsedJson.company_domain === 'string' && parsedJson.company_domain.trim()) {\n    result.company_domain = parsedJson.company_domain.trim();\n  }\n  if (typeof parsedJson.domain_reasoning === 'string' && parsedJson.domain_reasoning.trim()) {\n    result.domain_reasoning = parsedJson.domain_reasoning.trim();\n  }\n\n  // Entity status\n  if (typeof parsedJson.entity_status === 'string' && parsedJson.entity_status.trim()) {\n    const v = parsedJson.entity_status.trim();\n    result.entity_type = (v === 'Non-Profit') ? 'Non-Profit' : 'General';\n  }\n  if (typeof parsedJson.status_reasoning === 'string' && parsedJson.status_reasoning.trim()) {\n    result.entity_status_reasoning = parsedJson.status_reasoning.trim();\n  }\n  if (typeof parsedJson.nonprofit_classification === 'string' && parsedJson.nonprofit_classification.trim()) {\n    result.nonprofit_classification = parsedJson.nonprofit_classification.trim();\n  }\n\n  // Revenue (your new Perplexity content uses revenue_value / revenue_low / revenue_high)\n  if (typeof parsedJson.revenue_value === 'number') {\n    result.revenue_value = parsedJson.revenue_value;\n    result.revenue_found = true;\n  } else if (typeof parsedJson.latest_annual_revenue === 'number') {\n    // fallback for your older flat schema\n    result.revenue_value = parsedJson.latest_annual_revenue;\n    result.revenue_found = true;\n  }\n\n  // Range: revenue_low/high OR revenue_range string OR nested schema\n  if (typeof parsedJson.revenue_low === 'number') result.revenue_range_min = parsedJson.revenue_low;\n  if (typeof parsedJson.revenue_high === 'number') result.revenue_range_max = parsedJson.revenue_high;\n\n  if (typeof parsedJson.revenue_range === 'string' && parsedJson.revenue_range.trim()) {\n    const rr = parsedJson.revenue_range.trim();\n    const m = rr.match(/^\\s*([\\d,]+(?:\\.\\d+)?)\\s*-\\s*([\\d,]+(?:\\.\\d+)?)\\s*$/);\n    if (m) {\n      const minV = parseFloat(String(m[1]).replace(/,/g, ''));\n      const maxV = parseFloat(String(m[2]).replace(/,/g, ''));\n      if (!Number.isNaN(minV)) result.revenue_range_min = minV;\n      if (!Number.isNaN(maxV)) result.revenue_range_max = maxV;\n    }\n  }\n\n  if (typeof parsedJson.is_estimate === 'boolean') result.is_estimate = parsedJson.is_estimate;\n\n  if (typeof parsedJson.revenue_reasoning === 'string' && parsedJson.revenue_reasoning.trim()) {\n    result.revenue_reasoning = parsedJson.revenue_reasoning.trim();\n  } else if (typeof parsedJson.reasoning === 'string' && parsedJson.reasoning.trim()) {\n    result.revenue_reasoning = parsedJson.reasoning.trim();\n  }\n\n  // Sources inside assistant JSON\n  if (Array.isArray(parsedJson.sources)) {\n    for (const s of parsedJson.sources) {\n      if (s && typeof s === 'object' && typeof s.url === 'string' && s.url.trim()) {\n        embeddedUrls.push(s.url.trim());\n      }\n    }\n  }\n  if (Array.isArray(parsedJson.source_urls)) {\n    parsedJson.source_urls\n      .filter(u => typeof u === 'string' && u.trim() !== '')\n      .forEach(u => embeddedUrls.push(u.trim()));\n  }\n}\n\n// -----------------------------\n// 5) Fallback entity classification (only if still unknown)\n// -----------------------------\nconst nonprofitIndicators = [\n  'nonprofit','non-profit','not-for-profit','not for profit',\n  '501c','501(c)','501 c','501(c)(3)','501c3',\n  'public charity','foundation','religious organization'\n];\n\nconst lower = contentNoUrls.toLowerCase();\nif (result.entity_type === 'unknown') {\n  result.entity_type = nonprofitIndicators.some(str => lower.includes(str))\n    ? 'Non-Profit'\n    : 'General';\n}\n\n// -----------------------------\n// 6) Revenue extraction heuristic (only if not found via JSON)\n// -----------------------------\nif (!result.revenue_found) {\n  const revenueRegex =\n    /\\$?\\s*([\\d]{1,3}(?:,\\d{3})*(?:\\.\\d+)?|\\d+(?:\\.\\d+)?)(?:\\s*(million|m|billion|b|thousand|k)\\b)?/gi;\n\n  const text = contentNoUrls;\n  const revenueCandidates = [];\n  let m;\n\n  while ((m = revenueRegex.exec(text)) !== null) {\n    let numStr = m[1].replace(/,/g, '');\n    let number = parseFloat(numStr);\n    if (isNaN(number)) continue;\n\n    const unit = (m[2] || '').toLowerCase();\n    const idxAfter = m.index + m[0].length;\n    const tail = text.slice(idxAfter, idxAfter + 30).toLowerCase();\n    if (/(employee|employees|people|year|years)/.test(tail)) continue;\n\n    if (unit.startsWith('m')) number *= 1_000_000;\n    else if (unit.startsWith('b')) number *= 1_000_000_000;\n    else if (unit.startsWith('k') || unit.includes('thousand')) number *= 1_000;\n\n    if (number > 1_000_000_000_000) continue;\n\n    revenueCandidates.push(number);\n  }\n\n  if (revenueCandidates.length > 0) {\n    const maxRevenue = Math.max(...revenueCandidates);\n    result.revenue_value = maxRevenue;\n    result.revenue_found = true;\n  }\n}\n\n// revenue_display formatting (keep your $XM format)\nif (result.revenue_found && result.revenue_value != null) {\n  const millions = result.revenue_value / 1_000_000;\n  const rounded = Math.round(millions * 10) / 10;\n  result.revenue_display = `$${rounded.toFixed(1)}M`;\n}\n\n// -----------------------------\n// 7) Collect URLs as numbered list (wrapper + assistant + embedded)\n// -----------------------------\nconst urlSet = new Set();\n\n// (A) wrapper citations\nif (Array.isArray(wrapper.citations)) {\n  wrapper.citations.forEach(u => {\n    if (typeof u === 'string' && u.trim()) urlSet.add(u.trim());\n  });\n}\n\n// (B) wrapper search_results\nif (Array.isArray(wrapper.search_results)) {\n  for (const sr of wrapper.search_results) {\n    if (typeof sr === 'string' && sr.trim()) urlSet.add(sr.trim());\n    else if (sr && typeof sr === 'object') {\n      const u = sr.url || sr.link || sr.source_url || sr.href || '';\n      if (typeof u === 'string' && u.trim()) urlSet.add(u.trim());\n    }\n  }\n}\n\n// (C) embedded in content + assistant sources\nembeddedUrls.forEach(u => {\n  if (u && typeof u === 'string' && u.trim()) urlSet.add(u.trim());\n});\n\nconst sourceArray = [...urlSet];\nresult.source_urls = sourceArray;\nresult.source_urls_numbered = sourceArray.length\n  ? sourceArray.map((u, i) => `${i + 1}. ${u}`).join('\\n')\n  : '';\n\n// -----------------------------\n// 8) ALSO expose wrapper metadata as dedicated fields (so you can map easily)\n// -----------------------------\ndata.perplexity_id = wrapper.id ?? null;\ndata.perplexity_model = wrapper.model ?? null;\ndata.perplexity_created = wrapper.created ?? null;\ndata.perplexity_object = wrapper.object ?? null;\n\ndata.perplexity_usage = wrapper.usage ?? null;\ndata.perplexity_usage_total_tokens = wrapper.usage?.total_tokens ?? null;\ndata.perplexity_cost_total = wrapper.usage?.cost?.total_cost ?? null;\n\ndata.perplexity_search_context_size = wrapper.usage?.search_context_size ?? null;\n\n// Keep full structured search_results + citations too\ndata.perplexity_citations = Array.isArray(wrapper.citations) ? wrapper.citations : [];\ndata.perplexity_search_results = Array.isArray(wrapper.search_results) ? wrapper.search_results : [];\n\n// Keep the raw assistant content for debugging\ndata.perplexity_assistant_raw = content;\n\n// -----------------------------\n// 9) Attach normalized fields onto $json & return\n// -----------------------------\ndata.entity_type = result.entity_type;\ndata.nonprofit_classification = result.nonprofit_classification;\ndata.entity_status_reasoning = result.entity_status_reasoning;\n\ndata.company_domain = result.company_domain;\ndata.domain_reasoning = result.domain_reasoning;\n\ndata.revenue_value = result.revenue_value;\ndata.revenue_found = result.revenue_found;\ndata.revenue_display = result.revenue_display;\ndata.revenue_reasoning = result.revenue_reasoning;\n\ndata.revenue_range_min = result.revenue_range_min;\ndata.revenue_range_max = result.revenue_range_max;\ndata.is_estimate = result.is_estimate;\n\ndata.source_urls = result.source_urls;\ndata.source_urls_numbered = result.source_urls_numbered;\n\n// keep all assistant-parsed fields (no data loss)\ndata.perplexity_assistant_json = result.extra;\n\nreturn data;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1936,
        512
      ],
      "id": "c6e11a90-8584-452e-90d9-a938546b98af",
      "name": "Parse Data"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbwm-4_STkCPYKSqEDYu-XHPi6WuQs8Sy5s5FhRc6JAolTsRlvRyhNrcs2nFo_t6DtVKbQ/exec",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "{\n  \"trigger\": \"clearAllDataFormatting\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2368,
        384
      ],
      "id": "b7b784c0-fd9b-47bd-b2e1-56ff5cc59d3d",
      "name": "Clear Formatting"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "d9b89176-f2b1-4265-9bc3-0982f928c67a",
              "leftValue": "={{ $json['Updated?'] }}",
              "rightValue": "Processing",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        192,
        432
      ],
      "id": "d338ae6e-3891-4337-a90a-0520f6bdecbf",
      "name": "Filter Not Processing"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "d9b89176-f2b1-4265-9bc3-0982f928c67a",
              "leftValue": "={{ $json['Updated?'] }}",
              "rightValue": "Done",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            },
            {
              "id": "5191d5bb-5f1a-4652-9fb0-4dca647f6a5e",
              "leftValue": "={{ $json['Bureau Number'] }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        336,
        560
      ],
      "id": "4381415a-4707-4e26-98aa-0300f32696c9",
      "name": "Filter Not Done Revenue"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "d0ac9ffb-4c36-448b-a469-f9c9068e2749",
              "leftValue": "={{ $json.Processing }}",
              "rightValue": "Processing",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            },
            {
              "id": "f767b607-f3c0-4cf3-ae12-74111e2c98e3",
              "leftValue": "={{ $json.Processing }}",
              "rightValue": "Done",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            }
          ],
          "combinator": "or"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        512,
        144
      ],
      "id": "c4136f38-72d0-48f3-99e1-017700fdf32e",
      "name": "Filter Unprocessed EE"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "0. NEW HERE",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=0"
        },
        "event": "rowAdded",
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTrigger",
      "typeVersion": 1,
      "position": [
        64,
        160
      ],
      "id": "4193c9e5-d667-4ef3-bec8-cd06d0d7d5a5",
      "name": "Google Sheets Trigger1",
      "credentials": {
        "googleSheetsTriggerOAuth2Api": {
          "id": "8ZGBY0PyadPJ9WWA",
          "name": "Google Sheets Trigger account"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        1504,
        160
      ],
      "id": "59244c31-3776-4b0b-9e0e-8913bc63ddcb",
      "name": "Merge EE + Prompts"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "689aabbd-62bb-4cc2-bbd6-af6a3dd055c5",
              "leftValue": "={{ $json['Ready to Move to Address List (Trigger)?'] }}",
              "rightValue": "Yes",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "0d33542a-90fa-4dda-8cb4-e8ead3c8ab7b",
              "leftValue": "={{ $json['For-Profit/Non-Profit'] }}",
              "rightValue": "General",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "dc4d94a7-e162-43bf-9769-8866f74f5770",
              "leftValue": "={{ $json['Moved to Address Labels'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2320,
        768
      ],
      "id": "5c14ac60-bd47-429a-b093-d3e9c76d6468",
      "name": "Is For-Profit Ready"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "9330df30-b853-4bc3-a171-b20ee91865ad",
              "leftValue": "={{ $json['Ready to send to Address Labels Doc? (Trigger)'] }}",
              "rightValue": "Yes",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "3d104728-a4d9-4576-84c5-c2e2ad2147e9",
              "leftValue": "={{ $json['Sent to Doc'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2480,
        992
      ],
      "id": "e109dc41-47a2-4130-8489-4610cfcfe15b",
      "name": "Filter Unsent FP Labels"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 861775990,
          "mode": "list",
          "cachedResultName": "1. Filtered Accounts & POCs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=861775990"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Bureau Number": "={{ $json['Bureau Number'] }}",
            "Updated?": "Processing"
          },
          "matchingColumns": [
            "Bureau Number"
          ],
          "schema": [
            {
              "id": "Updated?",
              "displayName": "Updated?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "POC Done",
              "displayName": "POC Done",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Date Uploaded to Outreach (to \"WC Renewal\" Campaign)",
              "displayName": "Date Uploaded to Outreach (to \"WC Renewal\" Campaign)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Bureau Number",
              "displayName": "Bureau Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Street Address",
              "displayName": "Street Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "City",
              "displayName": "City",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "State",
              "displayName": "State",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Zip Code",
              "displayName": "Zip Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "County",
              "displayName": "County",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Governing Class",
              "displayName": "Governing Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Description",
              "displayName": "Description",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ex Mod Year",
              "displayName": "Ex Mod Year",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod",
              "displayName": "ExMod",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Updated On",
              "displayName": "Updated On",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod Change",
              "displayName": "ExMod Change",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SubClass1",
              "displayName": "SubClass1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Desc1",
              "displayName": "Desc1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SubClass2",
              "displayName": "SubClass2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Desc2",
              "displayName": "Desc2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear1",
              "displayName": "PriorExModYear1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod1",
              "displayName": "PriorExMod1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear2",
              "displayName": "PriorExModYear2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod2",
              "displayName": "PriorExMod2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear3",
              "displayName": "PriorExModYear3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod3",
              "displayName": "PriorExMod3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear4",
              "displayName": "PriorExModYear4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "For-Profit/Non-Profit",
              "displayName": "For-Profit/Non-Profit",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Profit/Non-Profit Reasoning",
              "displayName": "Profit/Non-Profit Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Industry",
              "displayName": "Industry",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SIC Code",
              "displayName": "SIC Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Revenue ($M)",
              "displayName": "Revenue ($M)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Revenue Reasoning",
              "displayName": "Revenue Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ready for Seamless.AI",
              "displayName": "Ready for Seamless.AI",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Prospect        ",
              "displayName": "Prospect        ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LI Profile",
              "displayName": "LI Profile",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ready to Move to Address List (Trigger)?",
              "displayName": "Ready to Move to Address List (Trigger)?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Moved to Address Labels",
              "displayName": "Moved to Address Labels",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Domain",
              "displayName": "Domain",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "POC #",
              "displayName": "POC #",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Verified Company Address",
              "displayName": "Verified Company Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Verifiy POC (method)",
              "displayName": "Verifiy POC (method)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Tenure (in role)",
              "displayName": "Tenure (in role)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2nd deg connections (R*)",
              "displayName": "2nd deg connections (R*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Common Network (P*)",
              "displayName": "Common Network (P*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LNKD Activity Level",
              "displayName": "LNKD Activity Level",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Unqiue notes for personalization (P*)",
              "displayName": "Unqiue notes for personalization (P*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "TBD",
              "displayName": "TBD",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "tbd",
              "displayName": "tbd",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        512,
        400
      ],
      "id": "ffc0ef03-f4b0-41bd-ba53-b1fde3e7fd30",
      "name": "Update to Processing",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 861775990,
          "mode": "list",
          "cachedResultName": "1. Filtered Accounts & POCs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=861775990"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "LI Profile": "={{ $json.linkedin_profile_url }}",
            "Prospect        ": "={{ $('LI Profile Batch Loop').item.json['Prospect        '] }}"
          },
          "matchingColumns": [
            "Prospect        "
          ],
          "schema": [
            {
              "id": "Updated?",
              "displayName": "Updated?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "POC Done",
              "displayName": "POC Done",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Date Uploaded to Outreach (to \"WC Renewal\" Campaign)",
              "displayName": "Date Uploaded to Outreach (to \"WC Renewal\" Campaign)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Bureau Number",
              "displayName": "Bureau Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Street Address",
              "displayName": "Street Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "City",
              "displayName": "City",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "State",
              "displayName": "State",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Zip Code",
              "displayName": "Zip Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "County",
              "displayName": "County",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Governing Class",
              "displayName": "Governing Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Description",
              "displayName": "Description",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ex Mod Year",
              "displayName": "Ex Mod Year",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod",
              "displayName": "ExMod",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Updated On",
              "displayName": "Updated On",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod Change",
              "displayName": "ExMod Change",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SubClass1",
              "displayName": "SubClass1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Desc1",
              "displayName": "Desc1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SubClass2",
              "displayName": "SubClass2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Desc2",
              "displayName": "Desc2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear1",
              "displayName": "PriorExModYear1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod1",
              "displayName": "PriorExMod1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear2",
              "displayName": "PriorExModYear2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod2",
              "displayName": "PriorExMod2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear3",
              "displayName": "PriorExModYear3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod3",
              "displayName": "PriorExMod3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear4",
              "displayName": "PriorExModYear4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "For-Profit/Non-Profit",
              "displayName": "For-Profit/Non-Profit",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Profit/Non-Profit Reasoning",
              "displayName": "Profit/Non-Profit Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Industry",
              "displayName": "Industry",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SIC Code",
              "displayName": "SIC Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Revenue ($M)",
              "displayName": "Revenue ($M)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Revenue Reasoning",
              "displayName": "Revenue Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ready for Seamless.AI",
              "displayName": "Ready for Seamless.AI",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Prospect        ",
              "displayName": "Prospect        ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LI Profile",
              "displayName": "LI Profile",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Ready to Move to Address List (Trigger)?",
              "displayName": "Ready to Move to Address List (Trigger)?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Moved to Address Labels",
              "displayName": "Moved to Address Labels",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Domain",
              "displayName": "Domain",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "POC #",
              "displayName": "POC #",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Verified Company Address",
              "displayName": "Verified Company Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Verifiy POC (method)",
              "displayName": "Verifiy POC (method)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Tenure (in role)",
              "displayName": "Tenure (in role)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2nd deg connections (R*)",
              "displayName": "2nd deg connections (R*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Common Network (P*)",
              "displayName": "Common Network (P*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LNKD Activity Level",
              "displayName": "LNKD Activity Level",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Unqiue notes for personalization (P*)",
              "displayName": "Unqiue notes for personalization (P*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "TBD",
              "displayName": "TBD",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "tbd",
              "displayName": "tbd",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1936,
        896
      ],
      "id": "24f83638-378b-4bbc-9c07-206777f569d0",
      "name": "Update LI Profile",
      "retryOnFail": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "8d40ffac-cc63-4de5-b0b8-dcae7217a5ad",
              "leftValue": "={{ $json['LI Profile'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1008,
        768
      ],
      "id": "fcc91312-f988-4c77-9056-0f77deef92fb",
      "name": "Has No LI Profile"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1360,
        768
      ],
      "id": "c5e55da3-8bcd-47e0-a0dd-d7611b63bccd",
      "name": "LI Profile Batch Loop"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 861775990,
          "mode": "list",
          "cachedResultName": "1. Filtered Accounts & POCs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=861775990"
        },
        "event": "rowUpdate",
        "options": {
          "columnsToWatch": [
            "Prospect        "
          ]
        }
      },
      "type": "n8n-nodes-base.googleSheetsTrigger",
      "typeVersion": 1,
      "position": [
        848,
        768
      ],
      "id": "2f6d4c8e-3711-466e-a965-4ca00c895d16",
      "name": "Trigger LI Profile Search",
      "credentials": {
        "googleSheetsTriggerOAuth2Api": {
          "id": "8ZGBY0PyadPJ9WWA",
          "name": "Google Sheets Trigger account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "d1af4d62-6121-489f-9907-ec76c6777cda",
              "leftValue": "={{ $('Trigger LI Profile Search').item.json['Prospect        '] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        1168,
        768
      ],
      "id": "9c5f57fd-964a-45a0-bc4f-e63a774c60d8",
      "name": "Prospect Name Exists"
    },
    {
      "parameters": {
        "jsCode": "// PURPOSE:\n// - Read output from the Apify LinkedIn Profile Search actor\n// - Return ONLY the LinkedIn profile URL\n// - If none exists, return \"None found\"\n\n// SAFETY:\n// - Handles empty items\n// - Handles missing fields\n// - Never throws\n\nconst items = $input.all();\n\nlet linkedinUrl = 'None found';\n\nfor (const item of items) {\n  const url =\n    item?.json?.linkedinUrl ??\n    item?.json?.linkedInUrl ??\n    item?.json?.linkedinURL ??\n    null;\n\n  if (typeof url === 'string' && url.trim() !== '') {\n    linkedinUrl = url.trim();\n    break;\n  }\n}\n\nreturn [\n  {\n    json: {\n      linkedin_profile_url: linkedinUrl,\n    },\n  },\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1760,
        768
      ],
      "id": "f42fa1aa-f877-472a-9da1-24df196f41e3",
      "name": "Check LI profile or Not"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 618105269,
          "mode": "list",
          "cachedResultName": "Address Labels (General)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=618105269"
        },
        "event": "rowUpdate",
        "options": {
          "columnsToWatch": [
            "Ready to send to Address Labels Doc? (Trigger)"
          ]
        }
      },
      "type": "n8n-nodes-base.googleSheetsTrigger",
      "typeVersion": 1,
      "position": [
        2336,
        992
      ],
      "id": "5fe17ea5-8551-4c75-96b1-4ed8e5d1b748",
      "name": "Trigger Address Labels FP",
      "credentials": {
        "googleSheetsTriggerOAuth2Api": {
          "id": "8ZGBY0PyadPJ9WWA",
          "name": "Google Sheets Trigger account"
        }
      }
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1567610270,
          "mode": "list",
          "cachedResultName": "Address Labels (Non-Profit)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=1567610270"
        },
        "event": "rowUpdate",
        "options": {
          "columnsToWatch": [
            "Ready to send to Address Labels Doc? (Trigger)"
          ]
        }
      },
      "type": "n8n-nodes-base.googleSheetsTrigger",
      "typeVersion": 1,
      "position": [
        2736,
        1360
      ],
      "id": "4b7acab0-5fe9-4927-b3f5-347c7f196f2a",
      "name": "Trigger Address Labels NP",
      "credentials": {
        "googleSheetsTriggerOAuth2Api": {
          "id": "8ZGBY0PyadPJ9WWA",
          "name": "Google Sheets Trigger account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Address Label (Code node)\n// MODE: Run Once for All Items\n// - Preserves existing Label # if already set on the row\n// - Assigns new Label # only when Prospect is present AND Label # is blank\n// - Skips rows with no definite contact (no Prospect)\n// - Outputs ONLY rows that should update the Doc + Sheet\n// - NOW: Tracks prospect name for bold formatting\nconst start =\n  $('Get Next Label Start1')?.first()?.json?.nextStart ??\n  $('Get Next Label Start1')?.item?.json?.nextStart ??\n  1;\nfunction extractLabelNumber(v) {\n  if (v == null) return null;\n  const s = String(v).trim();\n  const m = s.match(/\\{\\{\\s*Label\\s*(\\d+)\\s*\\}\\}/i);\n  return m ? Number(m[1]) : null;\n}\nfunction hasText(v) {\n  return v != null && String(v).trim() !== '';\n}\n// \"Definite contact\" = Prospect present\nfunction isDefiniteContact(r) {\n  return hasText(r['Prospect']);\n}\nlet assignedCount = 0;\nconst out = [];\nfor (const item of items) {\n  const r = item.json || {};\n  \n  // Skip if not a definite contact\n  if (!isDefiniteContact(r)) continue;\n  \n  // Build labelText\n  const prospect = r['Prospect'] ?? null;\n  const correctedName =\n    r['corrected_name'] ??\n    r['Corrected Name'] ??\n    r['Primary Name'] ??\n    null;\n  const street = r['Street Address'] ?? null;\n  const city = r['City'] ?? null;\n  const state = r['State'] ?? null;\n  const zip = r['Zip Code'] ?? null;\n  \n  const lines = [\n    prospect,\n    correctedName,\n    street,\n    [city, state, zip].filter(hasText).join(' '),\n  ].filter(hasText);\n  \n  const labelText = lines.join('\\n');\n  \n  // If labelText ended up empty somehow, skip\n  if (!hasText(labelText)) continue;\n  \n  // Preserve existing Label # if present\n  const existingLabelPlaceholder =\n    r['Label #'] ??\n    r['Label#'] ??\n    r.labelPlaceholder ??\n    null;\n  const existingN = extractLabelNumber(existingLabelPlaceholder);\n  \n  let labelIndex;\n  if (Number.isFinite(existingN) && existingN > 0) {\n    // KEEP existing label number\n    labelIndex = existingN;\n  } else {\n    // Assign next available label number\n    labelIndex = Number(start) + assignedCount;\n    assignedCount += 1;\n  }\n  \n  const labelPlaceholder = `{{Label${labelIndex}}}`;\n  \n  out.push({\n    json: {\n      ...r,\n      labelIndex,\n      labelPlaceholder,\n      labelText,\n      prospectName: prospect // For bold formatting\n    },\n  });\n}\nreturn out;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3040,
        1456
      ],
      "id": "183c6656-6188-4c64-8ede-3f5b435c7cd0",
      "name": "Address Label1"
    },
    {
      "parameters": {
        "operation": "update",
        "documentURL": "https://docs.google.com/document/d/1nbCmlopOeqEWwsJ4ckd3EaXoo2zWsvUpWdTH_Z9ij2w/edit?usp=sharing",
        "actionsUi": {
          "actionFields": [
            {
              "action": "replaceAll",
              "text": "={{ $('Doc Update NP Loop').item.json.labelPlaceholder }}",
              "replaceText": "={{ $('Doc Update NP Loop').item.json.labelText }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        3552,
        1360
      ],
      "id": "55a2ba1f-146c-40c8-b34c-30df2d77a49f",
      "name": "Update a document1",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "yPYUETCJjDJpwfng",
          "name": "Google Docs account"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1567610270,
          "mode": "list",
          "cachedResultName": "Address Labels (Non-Profit)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=1567610270"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Label": "={{ $json.labelText }}",
            "Label #": "={{ $json.labelPlaceholder }}",
            "Prospect": "={{ $json.Prospect }}",
            "Sent to Doc": "Done"
          },
          "matchingColumns": [
            "Prospect"
          ],
          "schema": [
            {
              "id": "row number",
              "displayName": "row number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Street Address",
              "displayName": "Street Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "City",
              "displayName": "City",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "State",
              "displayName": "State",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Zip Code",
              "displayName": "Zip Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Prospect",
              "displayName": "Prospect",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod",
              "displayName": "ExMod",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Corrected Name",
              "displayName": "Corrected Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Corrected Name Reasoning",
              "displayName": "Corrected Name Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Combined Address",
              "displayName": "Combined Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Test Label",
              "displayName": "Test Label",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Label",
              "displayName": "Label",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Label #",
              "displayName": "Label #",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Sent from A. Renewal",
              "displayName": "Sent from A. Renewal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ready to send to Address Labels Doc? (Trigger)",
              "displayName": "Ready to send to Address Labels Doc? (Trigger)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sent to Doc",
              "displayName": "Sent to Doc",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "useAppend": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3376,
        1360
      ],
      "id": "6631202c-ed45-4b85-8e7e-9c2d60ad6cca",
      "name": "Update Address List3",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Get Next Label Start (Code node)\n// MODE: Run Once for All Items\n// Reads all existing rows from Address Labels1 and finds the max {{LabelN}} already used\n\nconst rows = $items('If12') || [];\n\nfunction extractLabelNumber(v) {\n  if (v == null) return null;\n  const s = String(v).trim();\n  const m = s.match(/\\{\\{\\s*Label\\s*(\\d+)\\s*\\}\\}/i);\n  return m ? Number(m[1]) : null;\n}\n\nlet maxUsed = 0;\n\nfor (const it of rows) {\n  const r = it.json || {};\n\n  // Your sheet column header appears to be \"Label #\"\n  const n = extractLabelNumber(r['Label #'] ?? r['Label#'] ?? r['Label_Number']);\n  if (Number.isFinite(n) && n > maxUsed) maxUsed = n;\n}\n\nreturn [\n  {\n    json: {\n      maxUsed,\n      nextStart: maxUsed + 1,\n    },\n  },\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3040,
        1264
      ],
      "id": "4fd39929-3628-4786-8975-07eaeb7dde40",
      "name": "Get Next Label Start1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbxKuXfSswd_EzvmPMNsvf1zKP2bmP1HKButZzvU36pUC_JyHZ19O7u_DW7bHaP4qbyXSg/exec",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"trigger\": \"bold_lowercase\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        3712,
        1360
      ],
      "id": "ef757cd0-bf92-49b2-9a18-b4eb5adc8f55",
      "name": "Bold Labels1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "9330df30-b853-4bc3-a171-b20ee91865ad",
              "leftValue": "={{ $json['Sent to Address Labels Doc'] }}",
              "rightValue": "Done",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              }
            },
            {
              "id": "2ce1b355-f8a9-4a58-94e4-f8a6ed6758fa",
              "leftValue": "={{ $json['Sent to Doc'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2880,
        1360
      ],
      "id": "d962d41f-dcee-42ef-82b3-60ad69d48bfc",
      "name": "Filter Unsent NP Labels"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1567610270,
          "mode": "list",
          "cachedResultName": "Address Labels (Non-Profit)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=1567610270"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Corrected Name": "={{ $json.corrected_name }}",
            "Corrected Name Reasoning": "={{ $json.rationale }}",
            "Prospect": "={{ $('Update Address List6').item.json.Prospect }}"
          },
          "matchingColumns": [
            "Prospect"
          ],
          "schema": [
            {
              "id": "row number",
              "displayName": "row number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Street Address",
              "displayName": "Street Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "City",
              "displayName": "City",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "State",
              "displayName": "State",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Zip Code",
              "displayName": "Zip Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Prospect",
              "displayName": "Prospect",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod",
              "displayName": "ExMod",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Corrected Name",
              "displayName": "Corrected Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Corrected Name Reasoning",
              "displayName": "Corrected Name Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Combined Address",
              "displayName": "Combined Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Test Label",
              "displayName": "Test Label",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Label",
              "displayName": "Label",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Label #",
              "displayName": "Label #",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sent from A. Renewal",
              "displayName": "Sent from A. Renewal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ready to send to Address Labels Doc? (Trigger)",
              "displayName": "Ready to send to Address Labels Doc? (Trigger)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sent to Doc",
              "displayName": "Sent to Doc",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "useAppend": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2336,
        1424
      ],
      "id": "fb38fa7c-1ea9-4cb0-84f1-29dd386a4790",
      "name": "Update Address List5",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1856185975,
          "mode": "list",
          "cachedResultName": "Prompts",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=1856185975"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "specifyRangeA1",
              "range": "E1:F2"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2464,
        1264
      ],
      "id": "3a0ef560-25f7-449f-9882-4ffeed3e09a8",
      "name": "Prompts 2",
      "executeOnce": false,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// Parse Output (n8n Code node)\n// Mode: Run Once for Each Item\n// Reads model output from common OpenAI shapes\n// Returns: primary_name, corrected_name, confidence, rationale\n// (+ raw, parse_error for debugging)\n\nfunction stripCodeFences(s) {\n  if (typeof s !== \"string\") return s;\n  let out = s.trim();\n  out = out.replace(/^```(?:json)?\\s*/i, \"\");\n  out = out.replace(/```$/i, \"\");\n  return out.trim();\n}\n\nfunction extractFirstJsonObject(s) {\n  if (typeof s !== \"string\") return null;\n  const start = s.indexOf(\"{\");\n  if (start === -1) return null;\n  let depth = 0;\n  for (let i = start; i < s.length; i++) {\n    const ch = s[i];\n    if (ch === \"{\") depth++;\n    if (ch === \"}\") depth--;\n    if (depth === 0) return s.slice(start, i + 1);\n  }\n  return null;\n}\n\n// 1) Get raw model output text (support multiple shapes)\nlet raw =\n  $json?.output?.[0]?.content?.[0]?.text ??\n  $json?.output?.[0]?.content?.[0]?.output_text ??\n  $json?.output?.[0]?.content?.[0]?.logprobs?.text ??\n  $json?.choices?.[0]?.message?.content ??  // ADDED: OpenAI format\n  $json?.text ??\n  null;\n\n// NEW: allow direct object input (already-parsed JSON)\nif (raw == null && typeof $json === \"object\" && !Array.isArray($json)) {\n  raw = JSON.stringify($json);\n}\n\nraw = typeof raw === \"string\" ? raw : JSON.stringify(raw ?? \"\");\n\n// 2) Clean\nlet cleaned = stripCodeFences(raw);\n\n// 3) Parse (with double-parse for escaped JSON strings)\nlet parsed = null;\nlet parseError = null;\n\ntry {\n  parsed = JSON.parse(cleaned);\n  \n  // CRITICAL FIX: Check if parsed result is a STRING containing JSON\n  // This happens when LLM returns: \"{\\n \\\"key\\\": \\\"value\\\"\\n}\"\n  if (typeof parsed === \"string\") {\n    // It's a double-encoded JSON string - parse again\n    cleaned = stripCodeFences(parsed);\n    parsed = JSON.parse(cleaned);\n  }\n  \n} catch (e1) {\n  // Try extracting first JSON object\n  const candidate = extractFirstJsonObject(cleaned);\n  if (candidate) {\n    try {\n      parsed = JSON.parse(candidate);\n      \n      // Check again for double-encoding\n      if (typeof parsed === \"string\") {\n        cleaned = stripCodeFences(parsed);\n        parsed = JSON.parse(cleaned);\n      }\n      \n    } catch (e2) {\n      parseError = e2?.message || String(e2);\n    }\n  } else {\n    parseError = e1?.message || String(e1);\n  }\n}\n\n// Ensure parsed is a plain object\nif (!parsed || typeof parsed !== \"object\" || Array.isArray(parsed)) {\n  if (!parseError) parseError = \"Parsed JSON was not an object.\";\n  parsed = null;\n}\n\n// 4) Return ONE item\nreturn {\n  json: {\n    primary_name: parsed?.primary_name ?? null,\n    corrected_name: parsed?.corrected_name ?? null,\n    confidence: parsed?.confidence ?? null,\n    rationale: parsed?.rationale ?? null,\n    raw: cleaned,\n    parse_error: parseError,\n  },\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2176,
        1424
      ],
      "id": "e2feac77-ddb8-4d2a-91e1-26007e268458",
      "name": "Parse Output1"
    },
    {
      "parameters": {
        "batchSize": 10,
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2160,
        1264
      ],
      "id": "06e2f173-c384-4f86-901c-36ebd29ef299",
      "name": "Address Label NP Loop"
    },
    {
      "parameters": {
        "model": "sonar-pro",
        "messages": {
          "message": [
            {
              "content": "={{ $json['Corrected Name System Message'] }}",
              "role": "system"
            },
            {
              "content": "=Company Name: {{ $('Address Label NP Loop').item.json['Primary Name'] }}\nCompany Website: {{ $('Address Label NP Loop').item.json.CopyPasteURL }}\n\nAddress Details:\nStreet: {{ $('Address Label NP Loop').item.json['Street Address'] }}\nCity: {{ $('Address Label NP Loop').item.json.City }}\nState: {{ $('Address Label NP Loop').item.json.State }}\nGoverning Class: {{ $('Address Label NP Loop').item.json['Governing Class'] }}\nAdditional Description: {{ $('Address Label NP Loop').item.json.Description }}\n\n{{ $json['Corrected Name User Message'] }}"
            }
          ]
        },
        "options": {},
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.perplexity",
      "typeVersion": 1,
      "position": [
        2592,
        1264
      ],
      "id": "c37ea2da-1d1f-4b70-bafd-5f1db9f79b88",
      "name": "Corrected Name1",
      "credentials": {
        "perplexityApi": {
          "id": "ZvICVqGzHHK8ddU0",
          "name": "Perplexity account"
        }
      },
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "content": "# Step 5: Move Over Info to Address List (Non Profit)",
        "height": 416,
        "width": 1760,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2112,
        1184
      ],
      "typeVersion": 1,
      "id": "b21d72d9-26fa-43cb-ae65-af49dddd6654",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1567610270,
          "mode": "list",
          "cachedResultName": "Address Labels (Non-Profit)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=1567610270"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Prospect": "={{ $json['Prospect        '] }}",
            "Sent from A. Renewal": "Done",
            "ExMod": "={{ $json.ExMod }}",
            "Title": "={{ $json.Title }}",
            "Zip Code": "={{ $json['Zip Code'] }}",
            "State": "={{ $json.State }}",
            "City": "={{ $json.City }}",
            "Primary Name": "={{ $json['Primary Name'] }}",
            "Street Address": "={{ $json['Street Address'] }}"
          },
          "matchingColumns": [
            "Prospect"
          ],
          "schema": [
            {
              "id": "row number",
              "displayName": "row number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Street Address",
              "displayName": "Street Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "City",
              "displayName": "City",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "State",
              "displayName": "State",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Zip Code",
              "displayName": "Zip Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Prospect",
              "displayName": "Prospect",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ExMod",
              "displayName": "ExMod",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Corrected Name",
              "displayName": "Corrected Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Corrected Name Reasoning",
              "displayName": "Corrected Name Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Combined Address",
              "displayName": "Combined Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Test Label",
              "displayName": "Test Label",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Label",
              "displayName": "Label",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Label #",
              "displayName": "Label #",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sent from A. Renewal",
              "displayName": "Sent from A. Renewal",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Ready to send to Address Labels Doc? (Trigger)",
              "displayName": "Ready to send to Address Labels Doc? (Trigger)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Sent to Doc",
              "displayName": "Sent to Doc",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "useAppend": true
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2320,
        1264
      ],
      "id": "7a9e009a-a4e8-4d1d-ab03-423054422b94",
      "name": "Update Address List6",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 3
          },
          "conditions": [
            {
              "id": "448c47a6-2ad6-42d2-aeca-21d2002bdedf",
              "leftValue": "={{ $json['Ready to Move to Address List (Trigger)?'] }}",
              "rightValue": "Yes",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "9c9225f9-3841-4d1c-946d-7c04684d4a92",
              "leftValue": "={{ $json['Moved to Address Labels'] }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        2496,
        816
      ],
      "id": "05ca3c85-2dfd-4b94-bb03-77b1b4e7a3c5",
      "name": "Is Non-Profit Ready"
    },
    {
      "parameters": {
        "amount": 20
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        2176,
        1008
      ],
      "id": "1f21c7f6-3ee9-4196-92c4-50440c293a66",
      "name": "Wait NP Address Delay",
      "webhookId": "87b348e7-89b9-41c5-a7c9-af01cb2b0e4a"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        2928,
        992
      ],
      "id": "350fddb6-dd04-4cbc-86dd-9272a7efb2e6",
      "name": "Doc Update FP Loop"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        3248,
        1264
      ],
      "id": "3207a106-c5a6-4d69-a6fd-da9536c04131",
      "name": "Doc Update NP Loop"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 861775990,
          "mode": "list",
          "cachedResultName": "1. Filtered Accounts & POCs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=861775990"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Prospect        ": "={{ $('Update Address List').item.json.Prospect }}",
            "Moved to Address Labels": "Done"
          },
          "matchingColumns": [
            "Prospect        "
          ],
          "schema": [
            {
              "id": "Updated?",
              "displayName": "Updated?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "POC Done",
              "displayName": "POC Done",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Date Uploaded to Outreach (to \"WC Renewal\" Campaign)",
              "displayName": "Date Uploaded to Outreach (to \"WC Renewal\" Campaign)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Bureau Number",
              "displayName": "Bureau Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Street Address",
              "displayName": "Street Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "City",
              "displayName": "City",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "State",
              "displayName": "State",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Zip Code",
              "displayName": "Zip Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "County",
              "displayName": "County",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Governing Class",
              "displayName": "Governing Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Description",
              "displayName": "Description",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ex Mod Year",
              "displayName": "Ex Mod Year",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod",
              "displayName": "ExMod",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Updated On",
              "displayName": "Updated On",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod Change",
              "displayName": "ExMod Change",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SubClass1",
              "displayName": "SubClass1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Desc1",
              "displayName": "Desc1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SubClass2",
              "displayName": "SubClass2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Desc2",
              "displayName": "Desc2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear1",
              "displayName": "PriorExModYear1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod1",
              "displayName": "PriorExMod1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear2",
              "displayName": "PriorExModYear2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod2",
              "displayName": "PriorExMod2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear3",
              "displayName": "PriorExModYear3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod3",
              "displayName": "PriorExMod3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear4",
              "displayName": "PriorExModYear4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "For-Profit/Non-Profit",
              "displayName": "For-Profit/Non-Profit",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Profit/Non-Profit Reasoning",
              "displayName": "Profit/Non-Profit Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Industry",
              "displayName": "Industry",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SIC Code",
              "displayName": "SIC Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Revenue ($M)",
              "displayName": "Revenue ($M)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Revenue Reasoning",
              "displayName": "Revenue Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Form 5500 URL",
              "displayName": "Form 5500 URL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Prospect        ",
              "displayName": "Prospect        ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LI Profile",
              "displayName": "LI Profile",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ready to Move to Address List (Trigger)?",
              "displayName": "Ready to Move to Address List (Trigger)?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Moved to Address Labels",
              "displayName": "Moved to Address Labels",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Domain",
              "displayName": "Domain",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "POC #",
              "displayName": "POC #",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Verified Company Address",
              "displayName": "Verified Company Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Verifiy POC (method)",
              "displayName": "Verifiy POC (method)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Tenure (in role)",
              "displayName": "Tenure (in role)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2nd deg connections (R*)",
              "displayName": "2nd deg connections (R*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Common Network (P*)",
              "displayName": "Common Network (P*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LNKD Activity Level",
              "displayName": "LNKD Activity Level",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Unqiue notes for personalization (P*)",
              "displayName": "Unqiue notes for personalization (P*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "TBD",
              "displayName": "TBD",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "tbd",
              "displayName": "tbd",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3664,
        768
      ],
      "id": "810f132a-c398-4556-8e50-e1500a486b12",
      "name": "Update Done",
      "retryOnFail": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 861775990,
          "mode": "list",
          "cachedResultName": "1. Filtered Accounts & POCs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=861775990"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Moved to Address Labels": "Done",
            "Prospect        ": "={{ $json.Prospect }}"
          },
          "matchingColumns": [
            "Prospect        "
          ],
          "schema": [
            {
              "id": "Updated?",
              "displayName": "Updated?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "POC Done",
              "displayName": "POC Done",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Date Uploaded to Outreach (to \"WC Renewal\" Campaign)",
              "displayName": "Date Uploaded to Outreach (to \"WC Renewal\" Campaign)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Bureau Number",
              "displayName": "Bureau Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Primary Name",
              "displayName": "Primary Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Street Address",
              "displayName": "Street Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "City",
              "displayName": "City",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "State",
              "displayName": "State",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Zip Code",
              "displayName": "Zip Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "County",
              "displayName": "County",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Governing Class",
              "displayName": "Governing Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Description",
              "displayName": "Description",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ex Mod Year",
              "displayName": "Ex Mod Year",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod",
              "displayName": "ExMod",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Updated On",
              "displayName": "Updated On",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ExMod Change",
              "displayName": "ExMod Change",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SubClass1",
              "displayName": "SubClass1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Desc1",
              "displayName": "Desc1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SubClass2",
              "displayName": "SubClass2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Desc2",
              "displayName": "Desc2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear1",
              "displayName": "PriorExModYear1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod1",
              "displayName": "PriorExMod1",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear2",
              "displayName": "PriorExModYear2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod2",
              "displayName": "PriorExMod2",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear3",
              "displayName": "PriorExModYear3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExMod3",
              "displayName": "PriorExMod3",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "PriorExModYear4",
              "displayName": "PriorExModYear4",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "For-Profit/Non-Profit",
              "displayName": "For-Profit/Non-Profit",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Profit/Non-Profit Reasoning",
              "displayName": "Profit/Non-Profit Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Industry",
              "displayName": "Industry",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "SIC Code",
              "displayName": "SIC Code",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Revenue ($M)",
              "displayName": "Revenue ($M)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Revenue Reasoning",
              "displayName": "Revenue Reasoning",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Form 5500 URL",
              "displayName": "Form 5500 URL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Prospect        ",
              "displayName": "Prospect        ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Title",
              "displayName": "Title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LI Profile",
              "displayName": "LI Profile",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Ready to Move to Address List (Trigger)?",
              "displayName": "Ready to Move to Address List (Trigger)?",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Moved to Address Labels",
              "displayName": "Moved to Address Labels",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Domain",
              "displayName": "Domain",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "POC #",
              "displayName": "POC #",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Verified Company Address",
              "displayName": "Verified Company Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Verifiy POC (method)",
              "displayName": "Verifiy POC (method)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Tenure (in role)",
              "displayName": "Tenure (in role)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2nd deg connections (R*)",
              "displayName": "2nd deg connections (R*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Common Network (P*)",
              "displayName": "Common Network (P*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LNKD Activity Level",
              "displayName": "LNKD Activity Level",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Unqiue notes for personalization (P*)",
              "displayName": "Unqiue notes for personalization (P*)",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "TBD",
              "displayName": "TBD",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "tbd",
              "displayName": "tbd",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2528,
        1424
      ],
      "id": "9219806e-7ac0-4904-b276-15a76555ef6d",
      "name": "Update Done1",
      "retryOnFail": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "5LCmS6wgPcuFMzGP",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "Run actor and get dataset",
        "actorId": {
          "__rl": true,
          "value": "M2FMdjRVeF1HPGFcc",
          "mode": "list",
          "cachedResultName": "LinkedIn Profile Search Scraper No Cookies ✅ Find all people 📧 (harvestapi/linkedin-profile-search)",
          "cachedResultUrl": "https://console.apify.com/actors/M2FMdjRVeF1HPGFcc/input"
        },
        "customBody": "={\n    \"autoQuerySegmentation\": false,\n    \"currentJobTitles\": [\n        \"{{ $json.Title }}\"\n    ],\n    \"maxItems\": 1,\n    \"profileScraperMode\": \"Short\",\n    \"recentlyChangedJobs\": false,\n    \"searchQuery\": \"{{\n  (() => {\n    const name = ($json['Prospect        '] || '').trim();\n    const parts = name.split(/\\s+/);\n    if (parts.length <= 2) return name;\n    return parts[0] + ' ' + parts[parts.length - 1];\n  })()\n}}, {{\n  ($json['Primary Name'] || '')\n    .replace(/\\b(d\\/b\\/a|dba|llc|l\\.l\\.c\\.|inc|inc\\.|corp|corp\\.|corporation|co|co\\.|company|ltd|ltd\\.|pllc|llp|lp)\\b/gi, '')\n    .replace(/\\s{2,}/g, ' ')\n    .replace(/[.,]+$/g, '')\n    .trim()\n}}\"\n}",
        "timeout": {},
        "authentication": "apifyOAuth2Api"
      },
      "type": "@apify/n8n-nodes-apify.apify",
      "typeVersion": 1,
      "position": [
        1584,
        768
      ],
      "id": "e6c4b980-d987-4edf-8ccb-75675cb1b26b",
      "name": "Run an Actor and get dataset",
      "alwaysOutputData": true,
      "retryOnFail": true,
      "credentials": {
        "apifyOAuth2Api": {
          "id": "PO1vksW9LIJfnLey",
          "name": "Apify account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "594c2593-4d54-427c-87d5-a4e915f39d64",
              "leftValue": "={{ $json['Bureau Number'] }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        272,
        160
      ],
      "id": "95521297-8e66-42be-ae92-869903e1221a",
      "name": "Has Bureau Number"
    },
    {
      "parameters": {
        "amount": 15
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        2752,
        176
      ],
      "id": "38bcf601-6ca2-4f3b-9457-bd918c08ec74",
      "name": "Wait EE Cooldown",
      "webhookId": "074bc36d-d791-4681-8330-1f793b2b56d6"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "documentId": {
          "__rl": true,
          "value": "1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw",
          "mode": "list",
          "cachedResultName": "WC Prospects Import & Filtering (via Tech Stack)",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 861775990,
          "mode": "list",
          "cachedResultName": "1. Filtered Accounts & POCs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1mno3Gy9qotBKO36Qx28p8ft5krR3sncZis8lrBVC5Cw/edit#gid=861775990"
        },
        "event": "rowUpdate",
        "options": {
          "columnsToWatch": [
            "Ready to Move to Address List (Trigger)?"
          ]
        }
      },
      "type": "n8n-nodes-base.googleSheetsTrigger",
      "typeVersion": 1,
      "position": [
        2160,
        768
      ],
      "id": "e0860a8b-27a3-4723-a19a-ab9366f5d9b2",
      "name": "Move to Address Lab Sheets",
      "credentials": {
        "googleSheetsTriggerOAuth2Api": {
          "id": "8ZGBY0PyadPJ9WWA",
          "name": "Google Sheets Trigger account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "a3575277-4e2f-4845-9296-a235360e3b81",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        784,
        1312
      ],
      "id": "c27bf66c-f5a2-4a28-bbd4-7b84edccc52d",
      "name": "Seamless.AI Webhook",
      "webhookId": "a3575277-4e2f-4845-9296-a235360e3b81"
    }
  ],
  "pinData": {},
  "connections": {
    "Fetch EE Prompts": {
      "main": [
        [
          {
            "node": "Merge EE + Prompts",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "EE Batch Loop": {
      "main": [
        [],
        [
          {
            "node": "Has Bureau No EE",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check EE Updated OK": {
      "main": [
        [
          {
            "node": "Wait EE Cooldown",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update New Hire Sheet": {
      "main": [
        [
          {
            "node": "Update EE Sources",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update EE Sources": {
      "main": [
        [
          {
            "node": "Check EE Updated OK",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Revenue Updated OK": {
      "main": [
        [
          {
            "node": "Revenue Batch Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Renewal (Revenue)": {
      "main": [
        [
          {
            "node": "Update Revenue Sources",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Revenue Sources": {
      "main": [
        [
          {
            "node": "Wait Revenue Cooldown",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Renewal1": {
      "main": [
        [
          {
            "node": "Merge Revenue + Prompts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Revenue Prompts": {
      "main": [
        [
          {
            "node": "Merge Revenue + Prompts",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Revenue Batch Loop": {
      "main": [
        [
          {
            "node": "Send Format Rows trigger once",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Rev Calc",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Rev Calc": {
      "main": [
        [
          {
            "node": "Parse Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Run EE calc": {
      "main": [
        [
          {
            "node": "Parse EE data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Rows": {
      "main": [
        [
          {
            "node": "Clear Formatting",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Address Label": {
      "main": [
        [
          {
            "node": "Doc Update FP Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Address List": {
      "main": [
        [
          {
            "node": "Prompts 1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prompts 1": {
      "main": [
        [
          {
            "node": "Corrected Name",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Output": {
      "main": [
        [
          {
            "node": "Update Address List1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Address Label FP Loop": {
      "main": [
        [],
        [
          {
            "node": "Update Address List",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Address List2": {
      "main": [
        [
          {
            "node": "Update a document",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update a document": {
      "main": [
        [
          {
            "node": "Bold Labels",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has Bureau No EE": {
      "main": [
        [
          {
            "node": "Fetch EE Prompts",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge EE + Prompts",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "EE Batch Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait Revenue Cooldown": {
      "main": [
        [
          {
            "node": "Check Revenue Updated OK",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter Unprocessed Revenue": {
      "main": [
        [
          {
            "node": "Dedupe",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "Dedupe": {
      "main": [
        [
          {
            "node": "Revenue Batch Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Combine data": {
      "main": [
        [
          {
            "node": "Run EE calc",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Combine data1": {
      "main": [
        [
          {
            "node": "Filter Unprocessed Revenue",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Revenue + Prompts": {
      "main": [
        [
          {
            "node": "Combine data1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Corrected Name": {
      "main": [
        [
          {
            "node": "Parse Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Bold Labels": {
      "main": [
        [
          {
            "node": "Doc Update FP Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets Trigger": {
      "main": [
        [
          {
            "node": "Filter Not Processing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Format Rows trigger once": {
      "main": [
        [
          {
            "node": "Format Rows",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse EE data": {
      "main": [
        [
          {
            "node": "Update New Hire Sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Data": {
      "main": [
        [
          {
            "node": "Update Renewal (Revenue)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Clear Formatting": {
      "main": [
        []
      ]
    },
    "Filter Not Processing": {
      "main": [
        [
          {
            "node": "Filter Not Done Revenue",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter Not Done Revenue": {
      "main": [
        [
          {
            "node": "Update to Processing",
            "type": "main",
            "index": 0
          },
          {
            "node": "Renewal1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Fetch Revenue Prompts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter Unprocessed EE": {
      "main": [
        [
          {
            "node": "EE Batch Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets Trigger1": {
      "main": [
        [
          {
            "node": "Has Bureau Number",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge EE + Prompts": {
      "main": [
        [
          {
            "node": "Combine data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is For-Profit Ready": {
      "main": [
        [
          {
            "node": "Address Label FP Loop",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Is Non-Profit Ready",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter Unsent FP Labels": {
      "main": [
        [
          {
            "node": "Get Next Label Start",
            "type": "main",
            "index": 0
          },
          {
            "node": "Address Label",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has No LI Profile": {
      "main": [
        [
          {
            "node": "Prospect Name Exists",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LI Profile Batch Loop": {
      "main": [
        [],
        [
          {
            "node": "Run an Actor and get dataset",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update LI Profile": {
      "main": [
        [
          {
            "node": "LI Profile Batch Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger LI Profile Search": {
      "main": [
        [
          {
            "node": "Has No LI Profile",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prospect Name Exists": {
      "main": [
        [
          {
            "node": "LI Profile Batch Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check LI profile or Not": {
      "main": [
        [
          {
            "node": "Update LI Profile",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Address List1": {
      "main": [
        [
          {
            "node": "Update Done",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Address Label1": {
      "main": [
        [
          {
            "node": "Doc Update NP Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update a document1": {
      "main": [
        [
          {
            "node": "Bold Labels1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter Unsent NP Labels": {
      "main": [
        [
          {
            "node": "Get Next Label Start1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Address Label1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Address Labels FP": {
      "main": [
        [
          {
            "node": "Filter Unsent FP Labels",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Address List5": {
      "main": [
        [
          {
            "node": "Update Done1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prompts 2": {
      "main": [
        [
          {
            "node": "Corrected Name1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Output1": {
      "main": [
        [
          {
            "node": "Update Address List5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Address Label NP Loop": {
      "main": [
        [],
        [
          {
            "node": "Update Address List6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Corrected Name1": {
      "main": [
        [
          {
            "node": "Parse Output1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Address Labels NP": {
      "main": [
        [
          {
            "node": "Filter Unsent NP Labels",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Address List6": {
      "main": [
        [
          {
            "node": "Prompts 2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is Non-Profit Ready": {
      "main": [
        [
          {
            "node": "Wait NP Address Delay",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait NP Address Delay": {
      "main": [
        [
          {
            "node": "Address Label NP Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Doc Update FP Loop": {
      "main": [
        [],
        [
          {
            "node": "Update Address List2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Doc Update NP Loop": {
      "main": [
        [],
        [
          {
            "node": "Update Address List3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Bold Labels1": {
      "main": [
        [
          {
            "node": "Doc Update NP Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Address List3": {
      "main": [
        [
          {
            "node": "Update a document1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Done": {
      "main": [
        [
          {
            "node": "Address Label FP Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Done1": {
      "main": [
        [
          {
            "node": "Address Label NP Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Run an Actor and get dataset": {
      "main": [
        [
          {
            "node": "Check LI profile or Not",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has Bureau Number": {
      "main": [
        [
          {
            "node": "Filter Unprocessed EE",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking ‘Execute workflow’": {
      "main": [
        []
      ]
    },
    "Wait EE Cooldown": {
      "main": [
        [
          {
            "node": "EE Batch Loop",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Move to Address Lab Sheets": {
      "main": [
        [
          {
            "node": "Is For-Profit Ready",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false,
    "timeSavedMode": "fixed",
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": "REPLACE_WITH_ERROR_WORKFLOW_ID"
  },
  "versionId": "498ae5bd-780d-4468-87c0-f81b9c28b88e",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "ef3884035190f04f6d774f0cbf3faf455fb95d0d8be8da8aef3e801074c4f309"
  },
  "id": "PjYup8gyZbIyDeZT",
  "tags": []
}
